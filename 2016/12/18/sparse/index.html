<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="NFS supportNFS 4.2 adds the ability for the client to ‘see’ holes in the files, and therefore for the server to not have to transmit all those zeroesreadplus    123456789101112131415161.4.3.  Sparse F">
<meta property="og:type" content="article">
<meta property="og:title" content="sparse file data segment">
<meta property="og:url" content="http://example.com/2016/12/18/sparse/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="NFS supportNFS 4.2 adds the ability for the client to ‘see’ holes in the files, and therefore for the server to not have to transmit all those zeroesreadplus    123456789101112131415161.4.3.  Sparse F">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2016-12-18T13:31:17.000Z">
<meta property="article:modified_time" content="2023-09-05T08:47:50.198Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="sparse">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>sparse file data segment</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/probberechts">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2016/12/28/learn-zfs-internals-p1-p5/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2016/12/04/zfs_rollback/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2016/12/18/sparse/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2016/12/18/sparse/&text=sparse file data segment"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2016/12/18/sparse/&title=sparse file data segment"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2016/12/18/sparse/&is_video=false&description=sparse file data segment"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=sparse file data segment&body=Check out this article: http://example.com/2016/12/18/sparse/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2016/12/18/sparse/&title=sparse file data segment"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2016/12/18/sparse/&title=sparse file data segment"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2016/12/18/sparse/&title=sparse file data segment"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2016/12/18/sparse/&title=sparse file data segment"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2016/12/18/sparse/&name=sparse file data segment&description=&lt;h3 id=&#34;NFS-support&#34;&gt;&lt;a href=&#34;#NFS-support&#34; class=&#34;headerlink&#34; title=&#34;NFS support&#34;&gt;&lt;/a&gt;&lt;a href=&#34;https://serverfault.com/questions/731632/does-nfs-and-smb-support-sparse-files&#34;&gt;NFS support&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;NFS 4.2 adds the ability for the client to ‘see’ holes in the files, and therefore for the server to not have to transmit all those zeroes&lt;br&gt;&lt;a href=&#34;https://www.ietf.org/archive/id/draft-hildebrand-nfsv4-read-sparse-02.txt&#34;&gt;readplus&lt;/a&gt;   &lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1.4.3.  Sparse Files&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Sparse files are ones &lt;span class=&#34;built_in&#34;&gt;which&lt;/span&gt; have unallocated or uninitialized data&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;blocks as holes &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; the file.  Such holes are typically transferred as&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;0s during I/O. READ_PLUS (see Section 15.10) allows a server to send&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;back to the client metadata describing the hole and DEALLOCATE (see&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Section 15.4) allows the client to punch holes into a file.  In&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;addition, SEEK (see Section 15.11) is provided to scan &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; the next&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;hole or data from a given location.&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      union nfs_readplusresok4 switch  (readplusrestype4 resop) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         CASE READ_OK:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;              opaque          data&amp;lt;&amp;gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         CASE READ_HOLE:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;              nfs_readplusreshole   reshole4;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;Test-file&#34;&gt;&lt;a href=&#34;#Test-file&#34; class=&#34;headerlink&#34; title=&#34;Test file&#34;&gt;&lt;/a&gt;Test file&lt;/h3&gt;&lt;p&gt;ubuntu 16.04&lt;br&gt;ext4 file system&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;$ &lt;span class=&#34;built_in&#34;&gt;rm&lt;/span&gt; data-A&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$ &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &amp;#123;1..1500&amp;#125;; &lt;span class=&#34;keyword&#34;&gt;do&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$i&lt;/span&gt; &amp;gt;&amp;gt; data-A ; &lt;span class=&#34;keyword&#34;&gt;done&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$ filefrag -v data-A &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Filesystem &lt;span class=&#34;built_in&#34;&gt;type&lt;/span&gt; is: ef53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;File size of data-A is 6394 (2 blocks of 4096 bytes)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; ext:     logical_offset:        physical_offset: length:   expected: flags:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   0:        0..       0:    3464588..   3464588:      1:            &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   1:        1..       1:          0..         0:      1:    3464589: last,unknown_loc,delalloc,eof&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$ &lt;span class=&#34;built_in&#34;&gt;dd&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;=data-A of=data-A-1 bs=4096 count=1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$ &lt;span class=&#34;built_in&#34;&gt;dd&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;=data-A of=data-A-2 bs=4096 count=1 skip=1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$ &lt;span class=&#34;built_in&#34;&gt;head&lt;/span&gt; data-A-2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;1042&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;1043&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;1044&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;1045&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$ &lt;span class=&#34;built_in&#34;&gt;cat&lt;/span&gt; data-A-1 data-A-2 | &lt;span class=&#34;built_in&#34;&gt;md5sum&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30ef7f11d29b8ad47542e97ed9d2a398  -&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$ &lt;span class=&#34;built_in&#34;&gt;cat&lt;/span&gt; data-A | &lt;span class=&#34;built_in&#34;&gt;md5sum&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30ef7f11d29b8ad47542e97ed9d2a398  -&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2016/12/18/sparse/&t=sparse file data segment"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#NFS-support"><span class="toc-number">1.</span> <span class="toc-text">NFS support</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Test-file"><span class="toc-number">2.</span> <span class="toc-text">Test file</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Test-sparse-file"><span class="toc-number">3.</span> <span class="toc-text">Test sparse file</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dd-update"><span class="toc-number">4.</span> <span class="toc-text">dd update</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Expand-sparse-file"><span class="toc-number">5.</span> <span class="toc-text">Expand sparse file</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#About-fallocate"><span class="toc-number">6.</span> <span class="toc-text">About fallocate</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#collapse-range"><span class="toc-number">6.1.</span> <span class="toc-text">collapse-range</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#zero-range"><span class="toc-number">6.2.</span> <span class="toc-text">zero-range</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#punch-hole"><span class="toc-number">6.3.</span> <span class="toc-text">punch-hole</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        sparse file data segment
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">John Doe</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2016-12-18T13:31:17.000Z" itemprop="datePublished">2016-12-18</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/Storage/">Storage</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/sparse/" rel="tag">sparse</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h3 id="NFS-support"><a href="#NFS-support" class="headerlink" title="NFS support"></a><a target="_blank" rel="noopener" href="https://serverfault.com/questions/731632/does-nfs-and-smb-support-sparse-files">NFS support</a></h3><p>NFS 4.2 adds the ability for the client to ‘see’ holes in the files, and therefore for the server to not have to transmit all those zeroes<br><a target="_blank" rel="noopener" href="https://www.ietf.org/archive/id/draft-hildebrand-nfsv4-read-sparse-02.txt">readplus</a>   </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">1.4.3.  Sparse Files</span><br><span class="line"></span><br><span class="line">Sparse files are ones <span class="built_in">which</span> have unallocated or uninitialized data</span><br><span class="line">blocks as holes <span class="keyword">in</span> the file.  Such holes are typically transferred as</span><br><span class="line">0s during I/O. READ_PLUS (see Section 15.10) allows a server to send</span><br><span class="line">back to the client metadata describing the hole and DEALLOCATE (see</span><br><span class="line">Section 15.4) allows the client to punch holes into a file.  In</span><br><span class="line">addition, SEEK (see Section 15.11) is provided to scan <span class="keyword">for</span> the next</span><br><span class="line">hole or data from a given location.</span><br><span class="line"></span><br><span class="line">      union nfs_readplusresok4 switch  (readplusrestype4 resop) &#123;</span><br><span class="line">         CASE READ_OK:</span><br><span class="line">              opaque          data&lt;&gt;;</span><br><span class="line">         CASE READ_HOLE:</span><br><span class="line">              nfs_readplusreshole   reshole4;</span><br><span class="line">      &#125;;</span><br></pre></td></tr></table></figure>

<h3 id="Test-file"><a href="#Test-file" class="headerlink" title="Test file"></a>Test file</h3><p>ubuntu 16.04<br>ext4 file system</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">rm</span> data-A</span><br><span class="line">$ <span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..1500&#125;; <span class="keyword">do</span> <span class="built_in">echo</span> <span class="variable">$i</span> &gt;&gt; data-A ; <span class="keyword">done</span></span><br><span class="line">$ filefrag -v data-A </span><br><span class="line">Filesystem <span class="built_in">type</span> is: ef53</span><br><span class="line">File size of data-A is 6394 (2 blocks of 4096 bytes)</span><br><span class="line"> ext:     logical_offset:        physical_offset: length:   expected: flags:</span><br><span class="line">   0:        0..       0:    3464588..   3464588:      1:            </span><br><span class="line">   1:        1..       1:          0..         0:      1:    3464589: last,unknown_loc,delalloc,eof</span><br><span class="line">$ <span class="built_in">dd</span> <span class="keyword">if</span>=data-A of=data-A-1 bs=4096 count=1</span><br><span class="line">$ <span class="built_in">dd</span> <span class="keyword">if</span>=data-A of=data-A-2 bs=4096 count=1 skip=1</span><br><span class="line">$ <span class="built_in">head</span> data-A-2</span><br><span class="line">1</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cat</span> data-A-1 data-A-2 | <span class="built_in">md5sum</span></span><br><span class="line">30ef7f11d29b8ad47542e97ed9d2a398  -</span><br><span class="line">$ <span class="built_in">cat</span> data-A | <span class="built_in">md5sum</span></span><br><span class="line">30ef7f11d29b8ad47542e97ed9d2a398  -</span><br></pre></td></tr></table></figure>

<span id="more"></span>

<h3 id="Test-sparse-file"><a href="#Test-sparse-file" class="headerlink" title="Test sparse file"></a>Test sparse file</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">rm</span> ./data-A;<span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..1500&#125;; <span class="keyword">do</span> <span class="built_in">echo</span> <span class="variable">$i</span> &gt;&gt; data-A ; <span class="keyword">done</span></span><br><span class="line">$ filefrag -v data-A </span><br><span class="line">Filesystem <span class="built_in">type</span> is: ef53</span><br><span class="line">File size of data-A is 6393 (2 blocks of 4096 bytes)</span><br><span class="line"> ext:     logical_offset:        physical_offset: length:   expected: flags:</span><br><span class="line">   0:        0..       1:          0..         1:      2:             last,unknown_loc,delalloc,eof</span><br><span class="line">data-A: 1 extent found</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">dd</span> <span class="keyword">if</span>=/dev/zero of=<span class="built_in">test</span> bs=4096 count=0 seek=25 <span class="comment">#write 100K sparse file</span></span><br><span class="line">$ <span class="built_in">cat</span> data-A &gt;&gt; <span class="built_in">test</span></span><br><span class="line">$ <span class="built_in">ls</span> -lhs </span><br><span class="line">total 16K</span><br><span class="line">8.0K -rw-rw-r-- 1 <span class="built_in">test</span> <span class="built_in">test</span> 6.3K 12月 19 14:04 data-A</span><br><span class="line">8.0K -rw-rw-r-- 1 <span class="built_in">test</span> <span class="built_in">test</span> 107K 12月 19 14:06 <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line">$ <span class="built_in">df</span> -h / </span><br><span class="line">Filesystem      Size  Used Avail Use% Mounted on</span><br><span class="line">/dev/sda2       101G   35G   61G  37% /</span><br><span class="line"></span><br><span class="line">$ sudo dumpe2fs /dev/sda2 | grep -i <span class="string">&quot;Block size&quot;</span></span><br><span class="line">dumpe2fs 1.42.13 (17-May-2015)</span><br><span class="line">Block size:               4096</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$ filefrag -v data-A </span><br><span class="line">Filesystem <span class="built_in">type</span> is: ef53</span><br><span class="line">File size of data-A is 6393 (2 blocks of 4096 bytes)</span><br><span class="line"> ext:     logical_offset:        physical_offset: length:   expected: flags:</span><br><span class="line">   0:        0..       1:    3713508..   3713509:      2:             last,eof</span><br><span class="line">data-A: 1 extent found</span><br><span class="line"></span><br><span class="line">$ sudo <span class="built_in">dd</span> <span class="keyword">if</span>=/dev/sda2 of=test-1 bs=4096 count=1 skip=3713508</span><br><span class="line">$ <span class="built_in">head</span> test-1 </span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">tail</span> test-1</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">104</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cat</span> test-1 | <span class="built_in">md5sum</span></span><br><span class="line">27260c41d34d5a01f5fba073f9059a90  -</span><br><span class="line"></span><br><span class="line">$ filefrag -v <span class="built_in">test</span></span><br><span class="line">Filesystem <span class="built_in">type</span> is: ef53</span><br><span class="line">File size of <span class="built_in">test</span> is 108793 (27 blocks of 4096 bytes)</span><br><span class="line"> ext:     logical_offset:        physical_offset: length:   expected: flags:</span><br><span class="line">   0:       25..      26:    3713510..   3713511:      2:             last,eof</span><br><span class="line"><span class="built_in">test</span>: 1 extent found</span><br><span class="line"></span><br><span class="line">$ sudo <span class="built_in">dd</span> <span class="keyword">if</span>=/dev/sda2 of=test-s-1 bs=4096 count=1 skip=3713510</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">md5sum</span> <span class="built_in">test</span>-*</span><br><span class="line">27260c41d34d5a01f5fba073f9059a90  test-1</span><br><span class="line">27260c41d34d5a01f5fba073f9059a90  test-s-1</span><br><span class="line"></span><br><span class="line">$ sudo <span class="built_in">dd</span> <span class="keyword">if</span>=/dev/sda2 of=test-s-2 bs=4096 count=1 skip=3713511</span><br><span class="line"></span><br><span class="line"><span class="comment"># the checksum difference between test-s-2 and test</span></span><br><span class="line">$ hexdump test-s-2 | <span class="built_in">tail</span></span><br><span class="line">0000890 3431 3038 310a 3834 0a31 3431 3238 310a</span><br><span class="line">00008a0 3834 0a33 3431 3438 310a 3834 0a35 3431</span><br><span class="line">00008b0 3638 310a 3834 0a37 3431 3838 310a 3834</span><br><span class="line">00008c0 0a39 3431 3039 310a 3934 0a31 3431 3239</span><br><span class="line">00008d0 310a 3934 0a33 3431 3439 310a 3934 0a35</span><br><span class="line">00008e0 3431 3639 310a 3934 0a37 3431 3839 310a</span><br><span class="line">00008f0 3934 0a39 3531 3030 000a 0000 0000 0000</span><br><span class="line">0000900 0000 0000 0000 0000 0000 0000 0000 0000</span><br><span class="line">*</span><br><span class="line">0001000</span><br><span class="line"></span><br><span class="line">$ hexdump <span class="built_in">test</span> | <span class="built_in">tail</span></span><br><span class="line">001a870 0a33 3431 3437 310a 3734 0a35 3431 3637</span><br><span class="line">001a880 310a 3734 0a37 3431 3837 310a 3734 0a39</span><br><span class="line">001a890 3431 3038 310a 3834 0a31 3431 3238 310a</span><br><span class="line">001a8a0 3834 0a33 3431 3438 310a 3834 0a35 3431</span><br><span class="line">001a8b0 3638 310a 3834 0a37 3431 3838 310a 3834</span><br><span class="line">001a8c0 0a39 3431 3039 310a 3934 0a31 3431 3239</span><br><span class="line">001a8d0 310a 3934 0a33 3431 3439 310a 3934 0a35</span><br><span class="line">001a8e0 3431 3639 310a 3934 0a37 3431 3839 310a</span><br><span class="line">001a8f0 3934 0a39 3531 3030 000a               </span><br><span class="line">001a8f9</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>There are some of zero fill in the file bottom.<br>astersik (*) !(means same as the line above)[<a target="_blank" rel="noopener" href="http://superuser.com/questions/494245/what-does-an-asterisk-mean-in-hexdump-output]">http://superuser.com/questions/494245/what-does-an-asterisk-mean-in-hexdump-output]</a></p>
<h3 id="dd-update"><a href="#dd-update" class="headerlink" title="dd update"></a>dd update</h3><p>operate single byte</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">dd</span> <span class="keyword">if</span>=data-A of=data-A-1Byte bs=1  count=1 ibs=1 obs=1</span><br><span class="line">$ <span class="built_in">dd</span> <span class="keyword">if</span>=data-A of=data-A-skip-1byte bs=1  skip=2 count=1 ibs=1 obs=1 iflag=count_bytes iflag=skip_bytes</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">ls</span> -<span class="built_in">ls</span> | grep -i by</span><br><span class="line"></span><br><span class="line"><span class="comment">#first column is KiB , 4 is 4KiB</span></span><br><span class="line"><span class="comment">#sixth column is byte , 1 byte</span></span><br><span class="line"></span><br><span class="line">  4 -rw-rw-r-- 1 <span class="built_in">test</span> <span class="built_in">test</span>      1 12月 19 15:23 data-A-1Byte</span><br><span class="line">  4 -rw-rw-r-- 1 <span class="built_in">test</span> <span class="built_in">test</span>      1 12月 19 15:22 data-A-skip-1byte</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cat</span> data-A-1Byte</span><br><span class="line">1 $ <span class="built_in">cat</span> data-A-skip-1byte</span><br><span class="line">2</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">ls</span> -<span class="built_in">ls</span> <span class="built_in">test</span> data-A </span><br><span class="line">8 -rw-rw-r-- 1 <span class="built_in">test</span> <span class="built_in">test</span>   6393 12月 19 14:54 data-A</span><br><span class="line">8 -rw-rw-r-- 1 <span class="built_in">test</span> <span class="built_in">test</span> 108793 12月 19 15:30 <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line">$  <span class="built_in">dd</span> <span class="keyword">if</span>=<span class="built_in">test</span> of=test-data bs=1 count=6393 skip=102400 iflag=skip_bytes ibs=1 obs=1</span><br><span class="line">$ <span class="built_in">sha1sum</span>   data-A test-data <span class="built_in">test</span></span><br><span class="line">8f8374832cb6536f580eef3b316ad08293a47617  data-A</span><br><span class="line">8f8374832cb6536f580eef3b316ad08293a47617  test-data</span><br><span class="line">03e31af4c89c9003ee0f43e49a65ad2e24367024  <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line">$ hexdump data-A | <span class="built_in">tail</span></span><br><span class="line">0001870 0a33 3431 3437 310a 3734 0a35 3431 3637</span><br><span class="line">0001880 310a 3734 0a37 3431 3837 310a 3734 0a39</span><br><span class="line">0001890 3431 3038 310a 3834 0a31 3431 3238 310a</span><br><span class="line">00018a0 3834 0a33 3431 3438 310a 3834 0a35 3431</span><br><span class="line">00018b0 3638 310a 3834 0a37 3431 3838 310a 3834</span><br><span class="line">00018c0 0a39 3431 3039 310a 3934 0a31 3431 3239</span><br><span class="line">00018d0 310a 3934 0a33 3431 3439 310a 3934 0a35</span><br><span class="line">00018e0 3431 3639 310a 3934 0a37 3431 3839 310a</span><br><span class="line">00018f0 3934 0a39 3531 3030 000a               </span><br><span class="line">00018f9</span><br><span class="line">$ hexdump test-data | <span class="built_in">tail</span></span><br><span class="line">0001870 0a33 3431 3437 310a 3734 0a35 3431 3637</span><br><span class="line">0001880 310a 3734 0a37 3431 3837 310a 3734 0a39</span><br><span class="line">0001890 3431 3038 310a 3834 0a31 3431 3238 310a</span><br><span class="line">00018a0 3834 0a33 3431 3438 310a 3834 0a35 3431</span><br><span class="line">00018b0 3638 310a 3834 0a37 3431 3838 310a 3834</span><br><span class="line">00018c0 0a39 3431 3039 310a 3934 0a31 3431 3239</span><br><span class="line">00018d0 310a 3934 0a33 3431 3439 310a 3934 0a35</span><br><span class="line">00018e0 3431 3639 310a 3934 0a37 3431 3839 310a</span><br><span class="line">00018f0 3934 0a39 3531 3030 000a               </span><br><span class="line">00018f9</span><br><span class="line">$ hexdump <span class="built_in">test</span> | <span class="built_in">tail</span></span><br><span class="line">001a870 0a33 3431 3437 310a 3734 0a35 3431 3637</span><br><span class="line">001a880 310a 3734 0a37 3431 3837 310a 3734 0a39</span><br><span class="line">001a890 3431 3038 310a 3834 0a31 3431 3238 310a</span><br><span class="line">001a8a0 3834 0a33 3431 3438 310a 3834 0a35 3431</span><br><span class="line">001a8b0 3638 310a 3834 0a37 3431 3838 310a 3834</span><br><span class="line">001a8c0 0a39 3431 3039 310a 3934 0a31 3431 3239</span><br><span class="line">001a8d0 310a 3934 0a33 3431 3439 310a 3934 0a35</span><br><span class="line">001a8e0 3431 3639 310a 3934 0a37 3431 3839 310a</span><br><span class="line">001a8f0 3934 0a39 3531 3030 000a               </span><br><span class="line">001a8f9</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Expand-sparse-file"><a href="#Expand-sparse-file" class="headerlink" title="Expand sparse file"></a>Expand sparse file</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">truncate</span> -s 200K file.txt <span class="comment"># size=200K file.txt</span></span><br><span class="line"></span><br><span class="line">$ <span class="built_in">truncate</span> -s +256 test_bak</span><br><span class="line">$ <span class="built_in">ls</span> -<span class="built_in">ls</span>  test_bak </span><br><span class="line">108 -rw-rw-r-- 1 <span class="built_in">test</span> <span class="built_in">test</span> 109049 12月 19 16:36 test_bak</span><br><span class="line">$ <span class="built_in">ls</span> -<span class="built_in">ls</span>  <span class="built_in">test</span></span><br><span class="line">8 -rw-rw-r-- 1 <span class="built_in">test</span> <span class="built_in">test</span> 108793 12月 19 15:30 <span class="built_in">test</span></span><br><span class="line">$ <span class="built_in">echo</span> $((<span class="number">109049</span>-<span class="number">108793</span>))</span><br><span class="line">256</span><br><span class="line"></span><br><span class="line"><span class="comment">#recovery to orginal size</span></span><br><span class="line">$ <span class="built_in">truncate</span> -s -256 test_bak</span><br><span class="line"></span><br><span class="line"><span class="comment"># not sparse</span></span><br><span class="line"><span class="variable">$fallocate</span> -o 1M -l 1M 1M-file</span><br></pre></td></tr></table></figure>

<h3 id="About-fallocate"><a href="#About-fallocate" class="headerlink" title="About fallocate"></a>About <a target="_blank" rel="noopener" href="https://pelican.craoc.fr/sparse-file.html">fallocate</a></h3><h4 id="collapse-range"><a href="#collapse-range" class="headerlink" title="collapse-range"></a>collapse-range</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">rm</span> <span class="built_in">test</span>;<span class="keyword">for</span> i <span class="keyword">in</span> &#123;0..60000&#125;; <span class="keyword">do</span> <span class="built_in">echo</span> <span class="variable">$i</span> &gt;&gt; <span class="built_in">test</span>; <span class="keyword">done</span></span><br><span class="line">$ <span class="built_in">ls</span> -<span class="built_in">ls</span> <span class="built_in">test</span></span><br><span class="line">344 -rw-rw-r-- 1 <span class="built_in">test</span> <span class="built_in">test</span> 348896 12月 19 17:03 <span class="built_in">test</span></span><br><span class="line">$ <span class="built_in">cp</span> <span class="built_in">test</span> test2</span><br><span class="line">$ fallocate --collapse-range --offset 4096 --length 8192  test2 <span class="comment"># From 4096, delete length from 4096 delete 8192 length bytes</span></span><br><span class="line">$ <span class="built_in">dd</span> <span class="keyword">if</span>=<span class="built_in">test</span> of=test-dd-4096-8192 bs=4096 count=2 skip=4096 iflag=skip_bytes <span class="comment"># make sure delete length</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">head</span> test-dd-4096-8192 </span><br><span class="line">041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">tail</span> test-dd-4096-8192</span><br><span class="line">2670</span><br><span class="line">2671</span><br><span class="line">2672</span><br><span class="line">2673</span><br><span class="line">2674</span><br><span class="line">2675</span><br><span class="line">2676</span><br><span class="line">2677</span><br><span class="line">2678</span><br><span class="line">267</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">head</span> -n 1045 test2 | <span class="built_in">tail</span></span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">19   <span class="comment"># 1 041 and 267 9</span></span><br><span class="line">2680</span><br><span class="line">2681</span><br><span class="line">2682</span><br><span class="line"></span><br><span class="line"><span class="comment"># test in sparse file</span></span><br><span class="line">$ <span class="built_in">dd</span> <span class="keyword">if</span>=/dev/zero of=test-sparse bs=1M count=0 seek=1</span><br><span class="line">$ <span class="built_in">ls</span> -lsh</span><br><span class="line">total 344K</span><br><span class="line">344K -rw-rw-r-- 1 <span class="built_in">test</span> <span class="built_in">test</span> 341K 12月 19 17:03 <span class="built_in">test</span></span><br><span class="line">   0 -rw-rw-r-- 1 <span class="built_in">test</span> <span class="built_in">test</span> 1.0M 12月 19 17:23 test-sparse</span><br><span class="line">$ <span class="built_in">cat</span> <span class="built_in">test</span> &gt;&gt; test-sparse</span><br><span class="line">$ <span class="built_in">ls</span> -<span class="built_in">ls</span></span><br><span class="line">total 688</span><br><span class="line">344 -rw-rw-r-- 1 <span class="built_in">test</span> <span class="built_in">test</span>  348896 12月 19 17:03 <span class="built_in">test</span></span><br><span class="line">344 -rw-rw-r-- 1 <span class="built_in">test</span> <span class="built_in">test</span> 1397472 12月 19 17:23 test-sparse</span><br><span class="line"></span><br><span class="line">$ fallocate --collapse-range --offset 4096 --length 8192 test-sparse </span><br><span class="line">$ <span class="built_in">ls</span> -<span class="built_in">ls</span></span><br><span class="line">total 688</span><br><span class="line">344 -rw-rw-r-- 1 <span class="built_in">test</span> <span class="built_in">test</span>  348896 12月 19 17:03 <span class="built_in">test</span></span><br><span class="line">344 -rw-rw-r-- 1 <span class="built_in">test</span> <span class="built_in">test</span> 1389280 12月 19 17:24 test-sparse</span><br><span class="line"></span><br><span class="line">$ filefrag -v test-sparse </span><br><span class="line">Filesystem <span class="built_in">type</span> is: ef53</span><br><span class="line">File size of test-sparse is 1397472 (342 blocks of 4096 bytes)</span><br><span class="line"> ext:     logical_offset:        physical_offset: length:   expected: flags:</span><br><span class="line">   0:      254..     341:    3803866..   3803953:     88:             last,eof</span><br><span class="line"></span><br><span class="line">$ filefrag -v test-sparse </span><br><span class="line">Filesystem <span class="built_in">type</span> is: ef53</span><br><span class="line">File size of test-sparse is 1389280 (340 blocks of 4096 bytes)</span><br><span class="line"> ext:     logical_offset:        physical_offset: length:   expected: flags:</span><br><span class="line">   0:      252..     339:    3803866..   3803953:     88:             last,eof</span><br><span class="line">test-sparse: 1 extent found</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="zero-range"><a href="#zero-range" class="headerlink" title="zero-range"></a>zero-range</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cp</span>  <span class="built_in">test</span> test-sparse </span><br><span class="line">$ <span class="built_in">dd</span> <span class="keyword">if</span>=/dev/zero of=test-sparse bs=1M count=0 seek=1</span><br><span class="line">0+0 records <span class="keyword">in</span></span><br><span class="line">0+0 records out</span><br><span class="line">0 bytes copied, 0.000132755 s, 0.0 kB/s</span><br><span class="line">1d [<span class="built_in">test</span>:/tmp/test/test2] 130 $ filefrag -v test-sparse </span><br><span class="line">Filesystem <span class="built_in">type</span> is: ef53</span><br><span class="line">File size of test-sparse is 1048576 (256 blocks of 4096 bytes)</span><br><span class="line"> ext:     logical_offset:        physical_offset: length:   expected: flags:</span><br><span class="line">   0:        0..       2:     589896..    589898:      3:             last,unwritten</span><br><span class="line">test-sparse: 1 extent found</span><br><span class="line">1d [<span class="built_in">test</span>:/tmp/test/test2] $ <span class="built_in">cat</span> <span class="built_in">test</span> &gt;&gt; test-sparse </span><br><span class="line">1d [<span class="built_in">test</span>:/tmp/test/test2] $ filefrag -v test-sparse </span><br><span class="line">Filesystem <span class="built_in">type</span> is: ef53</span><br><span class="line">File size of test-sparse is 1397472 (342 blocks of 4096 bytes)</span><br><span class="line"> ext:     logical_offset:        physical_offset: length:   expected: flags:</span><br><span class="line">   0:        0..       2:     589896..    589898:      3:             unwritten</span><br><span class="line">   1:      256..     341:          0..        85:     86:     589899: last,unknown_loc,delalloc,eof</span><br><span class="line">test-sparse: 2 extents found</span><br><span class="line">$  <span class="built_in">head</span> test-sparse </span><br><span class="line">0</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line"></span><br><span class="line">$ fallocate --zero-range --offset 1048576 --length 128 test-sparse </span><br><span class="line">$ <span class="built_in">head</span> test-sparse </span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line"></span><br><span class="line">$ fallocate --zero-range --offset 1048576 --length 348896  test-sparse</span><br><span class="line"><span class="comment"># clear all</span></span><br></pre></td></tr></table></figure>

<h4 id="punch-hole"><a href="#punch-hole" class="headerlink" title="punch-hole"></a>punch-hole</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cat</span> <span class="built_in">test</span> &gt;&gt; test-sparse </span><br><span class="line">$ filefrag -v test-sparse </span><br><span class="line">Filesystem <span class="built_in">type</span> is: ef53</span><br><span class="line">File size of test-sparse is 1397472 (342 blocks of 4096 bytes)</span><br><span class="line"> ext:     logical_offset:        physical_offset: length:   expected: flags:</span><br><span class="line">   0:      256..     341:          0..        85:     86:             last,unknown_loc,delalloc,eof</span><br><span class="line">test-sparse: 1 extent found</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$cat</span> <span class="built_in">test</span> &gt;&gt; test-sparse </span><br><span class="line">$ <span class="built_in">ls</span> -<span class="built_in">ls</span></span><br><span class="line">total 688</span><br><span class="line">344 -rw-rw-r-- 1 <span class="built_in">test</span> <span class="built_in">test</span>  348896 12月 19 17:29 <span class="built_in">test</span></span><br><span class="line">344 -rw-rw-r-- 1 <span class="built_in">test</span> <span class="built_in">test</span> 1397472 12月 19 17:53 test-sparse</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">echo</span> ((<span class="number">4096</span>*<span class="number">256</span>)=<span class="number">1048576</span> ;((<span class="number">4096</span>*<span class="number">84</span>))=344064</span><br><span class="line"></span><br><span class="line"><span class="variable">$fallocate</span> --punch-hole --offset 1048576 --length 344064  test-sparse </span><br><span class="line">1d [<span class="built_in">test</span>:/tmp/test/test2] $ filefrag -v test-sparse </span><br><span class="line">Filesystem <span class="built_in">type</span> is: ef53</span><br><span class="line">File size of test-sparse is 1397472 (342 blocks of 4096 bytes)</span><br><span class="line"> ext:     logical_offset:        physical_offset: length:   expected: flags:</span><br><span class="line">   0:      340..     341:    3802396..   3802397:      2:             last,eof</span><br><span class="line">test-sparse: 1 extent found</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">ls</span> -<span class="built_in">ls</span> test-sparse </span><br><span class="line">8 -rw-rw-r-- 1 <span class="built_in">test</span> <span class="built_in">test</span> 1397472 12月 19 17:54 test-sparse</span><br><span class="line"></span><br><span class="line"><span class="comment"># space has recycled</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

  </div>
</article>


    <div class="blog-post-comments">
        <div id="utterances_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>


        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a target="_blank" rel="noopener" href="http://github.com/probberechts">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#NFS-support"><span class="toc-number">1.</span> <span class="toc-text">NFS support</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Test-file"><span class="toc-number">2.</span> <span class="toc-text">Test file</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Test-sparse-file"><span class="toc-number">3.</span> <span class="toc-text">Test sparse file</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dd-update"><span class="toc-number">4.</span> <span class="toc-text">dd update</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Expand-sparse-file"><span class="toc-number">5.</span> <span class="toc-text">Expand sparse file</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#About-fallocate"><span class="toc-number">6.</span> <span class="toc-text">About fallocate</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#collapse-range"><span class="toc-number">6.1.</span> <span class="toc-text">collapse-range</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#zero-range"><span class="toc-number">6.2.</span> <span class="toc-text">zero-range</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#punch-hole"><span class="toc-number">6.3.</span> <span class="toc-text">punch-hole</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2016/12/18/sparse/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2016/12/18/sparse/&text=sparse file data segment"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2016/12/18/sparse/&title=sparse file data segment"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2016/12/18/sparse/&is_video=false&description=sparse file data segment"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=sparse file data segment&body=Check out this article: http://example.com/2016/12/18/sparse/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2016/12/18/sparse/&title=sparse file data segment"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2016/12/18/sparse/&title=sparse file data segment"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2016/12/18/sparse/&title=sparse file data segment"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2016/12/18/sparse/&title=sparse file data segment"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2016/12/18/sparse/&name=sparse file data segment&description=&lt;h3 id=&#34;NFS-support&#34;&gt;&lt;a href=&#34;#NFS-support&#34; class=&#34;headerlink&#34; title=&#34;NFS support&#34;&gt;&lt;/a&gt;&lt;a href=&#34;https://serverfault.com/questions/731632/does-nfs-and-smb-support-sparse-files&#34;&gt;NFS support&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;NFS 4.2 adds the ability for the client to ‘see’ holes in the files, and therefore for the server to not have to transmit all those zeroes&lt;br&gt;&lt;a href=&#34;https://www.ietf.org/archive/id/draft-hildebrand-nfsv4-read-sparse-02.txt&#34;&gt;readplus&lt;/a&gt;   &lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1.4.3.  Sparse Files&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Sparse files are ones &lt;span class=&#34;built_in&#34;&gt;which&lt;/span&gt; have unallocated or uninitialized data&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;blocks as holes &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; the file.  Such holes are typically transferred as&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;0s during I/O. READ_PLUS (see Section 15.10) allows a server to send&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;back to the client metadata describing the hole and DEALLOCATE (see&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Section 15.4) allows the client to punch holes into a file.  In&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;addition, SEEK (see Section 15.11) is provided to scan &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; the next&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;hole or data from a given location.&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      union nfs_readplusresok4 switch  (readplusrestype4 resop) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         CASE READ_OK:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;              opaque          data&amp;lt;&amp;gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         CASE READ_HOLE:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;              nfs_readplusreshole   reshole4;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;Test-file&#34;&gt;&lt;a href=&#34;#Test-file&#34; class=&#34;headerlink&#34; title=&#34;Test file&#34;&gt;&lt;/a&gt;Test file&lt;/h3&gt;&lt;p&gt;ubuntu 16.04&lt;br&gt;ext4 file system&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;$ &lt;span class=&#34;built_in&#34;&gt;rm&lt;/span&gt; data-A&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$ &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &amp;#123;1..1500&amp;#125;; &lt;span class=&#34;keyword&#34;&gt;do&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$i&lt;/span&gt; &amp;gt;&amp;gt; data-A ; &lt;span class=&#34;keyword&#34;&gt;done&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$ filefrag -v data-A &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Filesystem &lt;span class=&#34;built_in&#34;&gt;type&lt;/span&gt; is: ef53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;File size of data-A is 6394 (2 blocks of 4096 bytes)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; ext:     logical_offset:        physical_offset: length:   expected: flags:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   0:        0..       0:    3464588..   3464588:      1:            &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   1:        1..       1:          0..         0:      1:    3464589: last,unknown_loc,delalloc,eof&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$ &lt;span class=&#34;built_in&#34;&gt;dd&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;=data-A of=data-A-1 bs=4096 count=1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$ &lt;span class=&#34;built_in&#34;&gt;dd&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;=data-A of=data-A-2 bs=4096 count=1 skip=1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$ &lt;span class=&#34;built_in&#34;&gt;head&lt;/span&gt; data-A-2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;1042&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;1043&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;1044&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;1045&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$ &lt;span class=&#34;built_in&#34;&gt;cat&lt;/span&gt; data-A-1 data-A-2 | &lt;span class=&#34;built_in&#34;&gt;md5sum&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30ef7f11d29b8ad47542e97ed9d2a398  -&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$ &lt;span class=&#34;built_in&#34;&gt;cat&lt;/span&gt; data-A | &lt;span class=&#34;built_in&#34;&gt;md5sum&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30ef7f11d29b8ad47542e97ed9d2a398  -&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2016/12/18/sparse/&t=sparse file data segment"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2023
    John Doe
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/probberechts">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

    <script type="text/javascript">
      var utterances_repo = '67e8c052/67e8c052.github.io';
      var utterances_issue_term = 'pathname';
      var utterances_label = 'blog-comments';
      var utterances_theme = 'github-dark';

      (function(){
          var script = document.createElement('script');

          script.src = 'https://utteranc.es/client.js';
          script.setAttribute('repo', utterances_repo);
          script.setAttribute('issue-term', 'pathname');
          script.setAttribute('label', utterances_label);
          script.setAttribute('theme', utterances_theme);
          script.setAttribute('crossorigin', 'anonymous');
          script.async = true;
          (document.getElementById('utterances_thread')).appendChild(script);
      }());
  </script>

</body>
</html>
