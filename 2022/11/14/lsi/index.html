<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Name Decoder1234567891011              --------Generation 1&#x3D;3Gb&#x2F;s SAS &#x2F; SATA, 2&#x3D;6 Gb&#x2F;s SAS &#x2F; SATA, 3&#x3D;12 Gb&#x2F;s SAS &#x2F; SATA              --------4&#x3D;12 Gb&#x2F;s SAS&#x2F; SATA&#x2F; PCIe3, 5&#x3D;12 Gb&#x2F;s SAS&#x2F; SATA&#x2F; PCIe4, 6&#x3D;2">
<meta property="og:type" content="article">
<meta property="og:title" content="LSI MegaRAID Fusion-MPT">
<meta property="og:url" content="http://example.com/2022/11/14/lsi/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Name Decoder1234567891011              --------Generation 1&#x3D;3Gb&#x2F;s SAS &#x2F; SATA, 2&#x3D;6 Gb&#x2F;s SAS &#x2F; SATA, 3&#x3D;12 Gb&#x2F;s SAS &#x2F; SATA              --------4&#x3D;12 Gb&#x2F;s SAS&#x2F; SATA&#x2F; PCIe3, 5&#x3D;12 Gb&#x2F;s SAS&#x2F; SATA&#x2F; PCIe4, 6&#x3D;2">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/img/lsi-3108-example-20191010.png">
<meta property="og:image" content="http://example.com/img/MegaRAID-setting-1.png">
<meta property="og:image" content="http://example.com/img/adapter_support_pi.png">
<meta property="og:image" content="http://example.com/img/create_r1.png">
<meta property="og:image" content="http://example.com/img/create_vd_pi.png">
<meta property="og:image" content="http://example.com/img/4K-pi.png">
<meta property="og:image" content="http://example.com/img/512B-pi.png">
<meta property="og:image" content="http://example.com/img/vd_support_pi.png">
<meta property="article:published_time" content="2022-11-14T07:04:04.000Z">
<meta property="article:modified_time" content="2022-11-15T01:48:19.672Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="lsi">
<meta property="article:tag" content="hba">
<meta property="article:tag" content="scsi">
<meta property="article:tag" content="sas">
<meta property="article:tag" content="megaraid">
<meta property="article:tag" content="fusion">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/lsi-3108-example-20191010.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>LSI MegaRAID Fusion-MPT</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/probberechts">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2022/11/14/mem/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2022/11/14/perf/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2022/11/14/lsi/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2022/11/14/lsi/&text=LSI MegaRAID Fusion-MPT"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2022/11/14/lsi/&title=LSI MegaRAID Fusion-MPT"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2022/11/14/lsi/&is_video=false&description=LSI MegaRAID Fusion-MPT"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=LSI MegaRAID Fusion-MPT&body=Check out this article: http://example.com/2022/11/14/lsi/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2022/11/14/lsi/&title=LSI MegaRAID Fusion-MPT"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2022/11/14/lsi/&title=LSI MegaRAID Fusion-MPT"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2022/11/14/lsi/&title=LSI MegaRAID Fusion-MPT"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2022/11/14/lsi/&title=LSI MegaRAID Fusion-MPT"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2022/11/14/lsi/&name=LSI MegaRAID Fusion-MPT&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2022/11/14/lsi/&t=LSI MegaRAID Fusion-MPT"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#Name-Decoder"><span class="toc-number">1.</span> <span class="toc-text">Name Decoder</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Got-megaraid-log"><span class="toc-number">2.</span> <span class="toc-text">Got megaraid log</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#show-dev-sn"><span class="toc-number"></span> <span class="toc-text">show dev sn</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Set-time"><span class="toc-number">1.</span> <span class="toc-text">Set time</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Set-cache-policy"><span class="toc-number">2.</span> <span class="toc-text">Set cache policy</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Create-raid10"><span class="toc-number">3.</span> <span class="toc-text">Create raid10</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Megaraid-FastPATH-for-SAS-x2F-SATA-SSD"><span class="toc-number">4.</span> <span class="toc-text">Megaraid FastPATH for SAS&#x2F;SATA SSD</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#case-1"><span class="toc-number">4.1.</span> <span class="toc-text">case 1</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cachevault"><span class="toc-number">5.</span> <span class="toc-text">Cachevault</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Get-all-megaraid-log-not-filter"><span class="toc-number">6.</span> <span class="toc-text">Get all megaraid log, not filter</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Show-raid-logic-info"><span class="toc-number">7.</span> <span class="toc-text">Show raid logic info</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Import-license"><span class="toc-number">8.</span> <span class="toc-text">Import license</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Backup-config"><span class="toc-number">9.</span> <span class="toc-text">Backup config</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Interrupt-BGI"><span class="toc-number">10.</span> <span class="toc-text">Interrupt BGI</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Rebuild-x2F-Migrate-x2F-init"><span class="toc-number">11.</span> <span class="toc-text">Rebuild&#x2F;Migrate&#x2F;init</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Make-device-good"><span class="toc-number">12.</span> <span class="toc-text">Make device good</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Make-JBOD"><span class="toc-number">13.</span> <span class="toc-text">Make JBOD</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Foreign-devices"><span class="toc-number">14.</span> <span class="toc-text">Foreign devices</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#About-Consistency-and-patrol-read"><span class="toc-number">15.</span> <span class="toc-text">About Consistency and patrol read</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Patrol-read"><span class="toc-number">15.1.</span> <span class="toc-text">Patrol read</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Consistency-Check"><span class="toc-number">16.</span> <span class="toc-text">Consistency Check</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Montor-cache-ECC-count"><span class="toc-number">17.</span> <span class="toc-text">Montor cache ECC count</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#About-device-write-cache-in-megaraid"><span class="toc-number">18.</span> <span class="toc-text">About device write cache in megaraid</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Flush-RAID-write-cache"><span class="toc-number">19.</span> <span class="toc-text">Flush RAID write cache</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#show-PHY"><span class="toc-number">20.</span> <span class="toc-text">show PHY</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Foreign-configurations"><span class="toc-number"></span> <span class="toc-text">Foreign configurations</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Dimmer-switch"><span class="toc-number">1.</span> <span class="toc-text">Dimmer switch</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Device"><span class="toc-number"></span> <span class="toc-text">Device</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#debug"><span class="toc-number">1.</span> <span class="toc-text">debug</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#log"><span class="toc-number">1.1.</span> <span class="toc-text">log</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Encolsure"><span class="toc-number">1.2.</span> <span class="toc-text">Encolsure</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#phy-err"><span class="toc-number">1.3.</span> <span class="toc-text">phy err</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#diag-adapter"><span class="toc-number">2.</span> <span class="toc-text">diag adapter</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Enable-SEP-for-Dell-PERC"><span class="toc-number">3.</span> <span class="toc-text">Enable SEP for Dell PERC</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Enable-JBOD"><span class="toc-number">4.</span> <span class="toc-text">Enable JBOD</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SAS-loading-balance"><span class="toc-number">5.</span> <span class="toc-text">SAS loading balance</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Driver-performance"><span class="toc-number">6.</span> <span class="toc-text">Driver performance</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Get-smart-info-from-LSI-megaraid"><span class="toc-number">7.</span> <span class="toc-text">Get smart info from LSI megaraid</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#performance-monitor"><span class="toc-number">8.</span> <span class="toc-text">performance monitor</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#T10-PI-for-megaraid"><span class="toc-number"></span> <span class="toc-text">T10 PI for megaraid</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#About-T10-rebuild-assist-for-megaraid"><span class="toc-number"></span> <span class="toc-text">About T10 rebuild assist for megaraid</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Enable-T10-data-protection-in-LSI-9380-8e"><span class="toc-number">1.</span> <span class="toc-text">Enable T10-data-protection in LSI 9380-8e</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Create-raid-and-enable-T10-pi-data-protection"><span class="toc-number">2.</span> <span class="toc-text">Create raid and enable T10-pi data protection</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Redhat-support"><span class="toc-number">3.</span> <span class="toc-text">Redhat support</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Upgrade-LSI-9500"><span class="toc-number">4.</span> <span class="toc-text">Upgrade LSI 9500</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Error-code"><span class="toc-number">5.</span> <span class="toc-text">Error code</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#qlogic-driver-debug"><span class="toc-number"></span> <span class="toc-text">qlogic driver debug</span></a>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        LSI MegaRAID Fusion-MPT
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">John Doe</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2022-11-14T07:04:04.000Z" itemprop="datePublished">2022-11-14</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/LSI/">LSI</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/fusion/" rel="tag">fusion</a>, <a class="tag-link-link" href="/tags/hba/" rel="tag">hba</a>, <a class="tag-link-link" href="/tags/lsi/" rel="tag">lsi</a>, <a class="tag-link-link" href="/tags/megaraid/" rel="tag">megaraid</a>, <a class="tag-link-link" href="/tags/sas/" rel="tag">sas</a>, <a class="tag-link-link" href="/tags/scsi/" rel="tag">scsi</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h4 id="Name-Decoder"><a href="#Name-Decoder" class="headerlink" title="Name Decoder"></a>Name Decoder</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">              --------Generation 1=3Gb/s SAS / SATA, 2=6 Gb/s SAS / SATA, 3=12 Gb/s SAS / SATA</span><br><span class="line">              --------4=12 Gb/s SAS/ SATA/ PCIe3, 5=12 Gb/s SAS/ SATA/ PCIe4, 6=24 Gb/s SAS/ SATA/ PCIe4 (Tri-mode)</span><br><span class="line">              | - Starts at &quot;0&quot;; This digit is used for changes that are meant show succession from an older version to a newer version.</span><br><span class="line">              | |</span><br><span class="line">MegaRAID SAS 9460 - 16i</span><br><span class="line">             | |     |</span><br><span class="line">             | |     ------------16x internal ports, the 4i4e= 4 of Internal and 4 of External ports</span><br><span class="line">             | ------Subcategory 0 = HBA Initiator / Target,1 = HBA Integrated RAID, 4 = MegaRAIDEntry (iMR)</span><br><span class="line">             | ------6 = MegaRAID Value,8 = MegaRAID Feature</span><br><span class="line">             ---Technology 9 = SATA+SAS+PCIe</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="Got-megaraid-log"><a href="#Got-megaraid-log" class="headerlink" title="Got megaraid log"></a>Got megaraid log</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">perccli64 /call show all logfile=megaraid.cfg</span><br><span class="line">perccli64 /call show events file=events.log</span><br><span class="line">perccli64 /call show termlog <span class="built_in">type</span>=config logfile=termlog.config</span><br><span class="line">perccli64 /call show termlog <span class="built_in">type</span>=contents logfile=termlog.contents</span><br><span class="line">perccli64 /call show eventloginfo</span><br><span class="line">perccli64 /call show dequeuelog file=dequeue.log</span><br><span class="line">perccli64 /call show alilog logfile=ali.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># clear the log</span></span><br><span class="line"><span class="comment">#perccli64 /c x set debug reset all</span></span><br><span class="line"><span class="comment">#perccli64 /call delete events</span></span><br><span class="line"><span class="comment">#perccli64 /call delete termlog</span></span><br></pre></td></tr></table></figure>

<h3 id="show-dev-sn"><a href="#show-dev-sn" class="headerlink" title="show dev sn"></a><a target="_blank" rel="noopener" href="https://serverfault.com/questions/751167/finding-the-serial-number-of-hard-disk-drives-on-a-supermicro-server-running-meg">show dev sn</a></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">$ storcli /c0/eALL/sALL show all | egrep <span class="string">&#x27;Device attributes|SN = &#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># led</span></span><br><span class="line">$ storcli /c0/e8/s2 start locate</span><br><span class="line">$ storcli /cALL <span class="built_in">set</span> activityforlocate=off</span><br><span class="line"></span><br><span class="line">$ sas3ircu 0 display</span><br><span class="line"></span><br><span class="line">Device is a Hard disk</span><br><span class="line">  Enclosure <span class="comment">#                             : 3</span></span><br><span class="line">  Slot <span class="comment">#                                  : 14</span></span><br><span class="line">  SAS Address                             : 0000000-0-0000-0000</span><br><span class="line">  State                                   : Ready (RDY)</span><br><span class="line">  Size (<span class="keyword">in</span> MB)/(<span class="keyword">in</span> sectors)               : 3815447/976754645</span><br><span class="line">  Manufacturer                            : HGST</span><br><span class="line">  Model Number                            : HUS726040AL4210</span><br><span class="line">  Firmware Revision                       : AD05</span><br><span class="line">  Serial No                               : 00000000</span><br><span class="line">  Unit Serial No(VPD)                     : 00000000</span><br><span class="line">  GUID                                    : 0000000000000000</span><br><span class="line">  Protocol                                : SAS</span><br><span class="line">  Drive Type                              : SAS_HDD</span><br><span class="line"></span><br><span class="line">sas3ircu 0 locate 3:14 on</span><br><span class="line">sas3ircu 0 locate 3:14 off</span><br></pre></td></tr></table></figure>

<h4 id="Set-time"><a href="#Set-time" class="headerlink" title="Set time"></a>Set time</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ perccli64 /call show time</span><br><span class="line">$ storcli64 /call <span class="built_in">set</span> time=yyyymmdd hh:mm:ss|systemtime</span><br><span class="line">$ timedatectl set-timezone Asia/XXXXXX</span><br><span class="line">$ storcli64 /call <span class="built_in">set</span> time=systemtime</span><br></pre></td></tr></table></figure>

<h4 id="Set-cache-policy"><a href="#Set-cache-policy" class="headerlink" title="Set cache policy"></a>Set cache policy</h4><p>Disable write back cache</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ storcli64 /c0/v0 set wrcache=wb/wt/awb rdcache=ra iopolicy=cached pdcache=on</span><br><span class="line">                                      |</span><br><span class="line">                                      ------always write back</span><br></pre></td></tr></table></figure>

<h4 id="Create-raid10"><a href="#Create-raid10" class="headerlink" title="Create raid10"></a>Create raid10</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ storcli64 /c0 add vd <span class="built_in">type</span>=raid10 drives=252:0-7 pdperarray=2 WT strip=64</span><br><span class="line">$ storcli64 /c0 add vd <span class="built_in">type</span>=raid5 drives=252:0,2,4,6 WT strip=64</span><br><span class="line">$ storcli64 /c0/vXX del force</span><br><span class="line"></span><br><span class="line">$ storcli64 /c0/e54/s43,44 add hotsparedrive <span class="comment">#global hs</span></span><br><span class="line">$ storcli64 /c0/e54/s43 add hotsparedrive dgs=0,1 <span class="comment">#as Dedicated Hot spare for disk groups 0,1</span></span><br><span class="line">$ storcli64 /c0/e54/s43 delete hotsparedrive <span class="comment">#deletes a hot spare drive</span></span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://support.huawei.com/enterprise/en/doc/EDOC1000111853?section=j005">reference</a></p>
<p><a target="_blank" rel="noopener" href="https://support.huawei.com/enterprise/en/doc/EDOC1000111853?section=j005">RAID cache policy</a><br><img src="/img/lsi-3108-example-20191010.png"><br>Read Policy</p>
<ul>
<li>No Read Ahead: disables the Read Ahead function.</li>
<li>Read Ahead: enables the Read Ahead function. The controller pre-reads sequential data or the data predicted to be used and saves it in the cache.</li>
</ul>
<p>Write Policy</p>
<ul>
<li>Write Back: After the controller cache receives all data, the controller sends the host a message indicating that data transmission is complete.</li>
<li>Write Through: After the drive subsystem receives all data, the controller sends the host a message indicating that data transmission is complete.</li>
<li>Always Write Back: Virtual drive remains in Write Back mode if the capacitor fails or no capacitor exists.</li>
</ul>
<p>I&#x2F;O Policy</p>
<ul>
<li>Direct: Data is read directly and is not cached. This is the recommended mode for common configuration.</li>
<li>Cached: All data is read from cache. This is the recommended mode for CacheCade.</li>
</ul>
<p>Access Policy</p>
<ul>
<li>Read&#x2F;Write: Read and write operations are allowed.</li>
<li>Read Only: The virtual drive is read-only.</li>
<li>Blocked: The virtual drive is locked from access.</li>
</ul>
<p>Drive Cache</p>
<ul>
<li><p>Unchanged: uses the current cache policy.</p>
</li>
<li><p>Enable: writes data to the cache before writing data to the hard drive. This option improves data write performance. However, data may be lost if there is no protection mechanism against power failures.</p>
</li>
<li><p>Disable: writes data to a hard drive without caching the data. Data is not lost if power failures occur.</p>
</li>
<li><p>If the member drive is 512B&#x2F;512B:</p>
<ul>
<li>Default: The logical drive sector is 512B&#x2F;512B.</li>
<li>None: The logical drive sector is 512B&#x2F;512B.</li>
<li>Force: The logical drive sector is 512B&#x2F;4KB.</li>
</ul>
</li>
<li><p>If the member drive is 512B&#x2F;4KB:</p>
<ul>
<li>Default: The logical drive sector is 512B&#x2F;4KB.</li>
<li>None: The logical drive sector is 512B&#x2F;512B.</li>
<li>Force: The logical drive sector is 512B&#x2F;4KB.</li>
</ul>
</li>
</ul>
<h4 id="Megaraid-FastPATH-for-SAS-x2F-SATA-SSD"><a href="#Megaraid-FastPATH-for-SAS-x2F-SATA-SSD" class="headerlink" title="Megaraid FastPATH for SAS&#x2F;SATA SSD"></a>Megaraid FastPATH for SAS&#x2F;SATA SSD</h4><h5 id="case-1"><a href="#case-1" class="headerlink" title="case 1"></a><a target="_blank" rel="noopener" href="https://lenovopress.com/lp0592.pdf">case 1</a></h5><p>Suggest RAID5<br>To benefit from FastPath, an array must be defined using these specific parameters:</p>
<ul>
<li>Write Through</li>
<li>Direct IO</li>
<li>No Read Ahead</li>
<li>64KB stripe size (for most workloads)</li>
<li>RAID 5(fastpath support all raid level)</li>
<li>Disk Cache Policy: This controls the write cache policy for the drives in the arrays (as opposed to the write cache policy of the RAID adapter). Enabling disk write caching can put data at risk.<ul>
<li>full initialization</li>
</ul>
</li>
</ul>
<p>With FastPath enabled, and when certain conditions are met, the MegaRAID software stack running on the RAID controller can bypass portions of the software stack, resulting in a highly efficient, streamlined code path that the RAID controller can execute very quickly. This means that the RAID controller can handle more trips though its code in a given amount of time, which equates to higher possible IOPS.</p>
<p>FastPath is not designed to speed up slow storage. It will not have an effect on storage performance unless the RAID controller is the bottleneck. If the controller itself is limiting storage performance, then enabling FastPath will allow the controller to run faster, raising performance. FastPath is not meant for use with HDD storage nor is it meant for sequential workloads.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line">$ storcli64 /c0 show aso</span><br><span class="line">Controller = 0</span><br><span class="line">Status = Success</span><br><span class="line">Description = None</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Premium Feature Key :</span><br><span class="line">===================</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">Adv S/W Opt                 Time Remaining  Mode</span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">MegaRAID FastPath           Unlimited       Secured</span><br><span class="line">MegaRAID CacheCade Pro 2.0  Unlimited       Secured</span><br><span class="line">MegaRAID RAID6              Unlimited       Factory Installed</span><br><span class="line">MegaRAID RAID5              Unlimited       Factory Installed</span><br><span class="line">--------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Re-host Information :</span><br><span class="line">===================</span><br><span class="line">Needs Re-hosting = NO</span><br><span class="line">``</span><br><span class="line"></span><br><span class="line"><span class="comment">##### [Case 2: Aerospike Certification Tool](https://www.aerospike.com/docs/operations/plan/ssd/lsi_megacli.html)</span></span><br><span class="line">RAID Level      0</span><br><span class="line">Write Policy    Write Through</span><br><span class="line">Read Policy     No Read Ahead</span><br><span class="line">IO Policy       Direct IO</span><br><span class="line">Other           No write to cache <span class="keyword">if</span> bad BBU</span><br><span class="line"></span><br><span class="line">Dell R720xd</span><br><span class="line">PERC H710p RAID controller</span><br><span class="line">8 x 200 GB Intel s3700 SSDs</span><br><span class="line"></span><br><span class="line">Latency measures during torture tests (96,000 reads/sec and 48,000 concurrent writes/second).</span><br><span class="line">RAID setting    % &gt;1 ms % &gt;2 ms % &gt;4 ms % &gt;8 ms % &gt;16 ms</span><br><span class="line">Default         22.20   13.96   4.29    0.22    0.00</span><br><span class="line">FastPath™       4.31    0.85    0.17    0.00    0.00</span><br><span class="line"></span><br><span class="line">The latencies <span class="keyword">for</span> the FastPath™ are much better. In general better latency results mean much higher threshold <span class="keyword">for</span> throughput.</span><br><span class="line"></span><br><span class="line"><span class="comment">#### Storcli replace Megacli</span></span><br><span class="line"><span class="comment">##### BBU info</span></span><br><span class="line">```bash</span><br><span class="line">$ /opt/MegaRAID/MegaCli/MegaCli64 -AdpBbuCmd -getBbuProperties -aALL</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">BBU Properties <span class="keyword">for</span> Adapter: 0</span><br><span class="line"></span><br><span class="line">  Auto Learn Period: 30 Days</span><br><span class="line">  Next Learn time: Mon Jun  3 12:02:38 2019</span><br><span class="line"></span><br><span class="line">  Learn Delay Interval:0 Hours</span><br><span class="line">  Auto-Learn Mode: Enabled</span><br><span class="line">  BBU Mode = 4</span><br><span class="line"></span><br><span class="line">$ /opt/MegaRAID/storcli/storcli64 /call/bbu show properties</span><br><span class="line">Controller = 0</span><br><span class="line">Status = Success</span><br><span class="line">Description = None</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">BBU_Properties :</span><br><span class="line">==============</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">Property             Value</span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">Auto Learn Period    30d (2592000 seconds)</span><br><span class="line">Next Learn time      2019/06/03  12:02:38 (612878558 seconds)</span><br><span class="line">Learn Delay Interval 0 hour(s)</span><br><span class="line">Auto-Learn Mode      Enabled</span><br><span class="line">BBU Mode             4</span><br><span class="line">--------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">$ /opt/MegaRAID/storcli/storcli64 /call/bbu show status</span><br><span class="line">Controller = 0</span><br><span class="line">Status = Success</span><br><span class="line">Description = None</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">BBU_Info :</span><br><span class="line">========</span><br><span class="line"></span><br><span class="line">------------------------------------------------------------------</span><br><span class="line">Property      Value</span><br><span class="line">------------------------------------------------------------------</span><br><span class="line">BatteryType   iBBU08</span><br><span class="line">Voltage       4056 mV</span><br><span class="line">Current       0 mA</span><br><span class="line">Temperature   31 C</span><br><span class="line">Battery State Optimal</span><br><span class="line">Design Mode   1: 12+ Hrs retention with a transparent learn cycle</span><br><span class="line">                 and best service life.</span><br><span class="line">------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">BBU_Firmware_Status :</span><br><span class="line">===================</span><br><span class="line"></span><br><span class="line">-------------------------------------------------</span><br><span class="line">Property                                   Value</span><br><span class="line">-------------------------------------------------</span><br><span class="line">Charging Status                            None</span><br><span class="line">Voltage                                    OK</span><br><span class="line">Temperature                                OK</span><br><span class="line">Learn Cycle Requested                      No</span><br><span class="line">Learn Cycle Active                         No</span><br><span class="line">Learn Cycle Status                         OK</span><br><span class="line">Learn Cycle Timeout                        No</span><br><span class="line">I2C Errors Detected                        No</span><br><span class="line">Battery Pack Missing                       No</span><br><span class="line">Battery Replacement required               No</span><br><span class="line">Remaining Capacity Low                     No</span><br><span class="line">Periodic Learn Required                    No</span><br><span class="line">Transparent Learn                          No</span><br><span class="line">No space to cache offload                  No</span><br><span class="line">Pack is about to fail &amp; should be replaced No</span><br><span class="line">Cache Offload premium feature required     No</span><br><span class="line">Module microcode update required           No</span><br><span class="line">-------------------------------------------------</span><br><span class="line"></span><br><span class="line">GasGaugeStatus :</span><br><span class="line">==============</span><br><span class="line"></span><br><span class="line">--------------------------------------</span><br><span class="line">Property                   Value</span><br><span class="line">--------------------------------------</span><br><span class="line">Fully Discharged           No</span><br><span class="line">Fully Charged              No</span><br><span class="line">Discharging                No</span><br><span class="line">Initialized                Yes</span><br><span class="line">Remaining Time Alarm       No</span><br><span class="line">Terminate Discharge Alarm  No</span><br><span class="line">Over Temperature           No</span><br><span class="line">Charging Terminated        No</span><br><span class="line">Over Charged               No</span><br><span class="line">Relative State of Charge   97%</span><br><span class="line">Charger System State       1</span><br><span class="line">Charger System Ctrl        0</span><br><span class="line">Charging current           0 mA</span><br><span class="line">Absolute state of charge   78%</span><br><span class="line">Max Error                  0%</span><br><span class="line">Battery backup charge time 48 hours +</span><br><span class="line">--------------------------------------</span><br><span class="line"></span><br><span class="line">$ /opt/MegaRAID/storcli/storcli64 /call/bbu show status | grep -i <span class="built_in">type</span></span><br><span class="line">BatteryType   iBBU08</span><br><span class="line"></span><br><span class="line"><span class="comment">#important value</span></span><br><span class="line">Remaining Capacity Low                  : No</span><br><span class="line"></span><br><span class="line"><span class="comment">#design capacity: 1500, max</span></span><br><span class="line">Relative State of Charge ＝ 1055 ／ 1198 ～ 89%</span><br><span class="line">Absolute State of charge ＝ 1055 ／ 1500 ～ 70%</span><br></pre></td></tr></table></figure>
<p>set BBU policy  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">$ storcli /cx/bbu <span class="built_in">set</span> learnDelayInterval=168 <span class="comment">#hours</span></span><br><span class="line"></span><br><span class="line">$ /opt/MegaRAID/storcli/storcli64 /call/bbu show modes</span><br><span class="line">Controller = 0</span><br><span class="line">Status = Success</span><br><span class="line">Description = Get BBU Modes Succeeded.</span><br><span class="line"></span><br><span class="line">Available BBU Modes :</span><br><span class="line">===================</span><br><span class="line">Mode-1 = 12+ Hrs retention with a transparent learn cycle and best service life.</span><br><span class="line">Mode-3 = 24+ Hrs retention with a transparent learn cycle and balanced service life.</span><br><span class="line">Mode-4 = 48+ Hrs retention with a non-transparent learn cycle and balanced service life</span><br><span class="line"></span><br><span class="line">$ storcli /cx/bbu <span class="built_in">set</span> bbuMode=&lt;value&gt;</span><br><span class="line">0 48 hours of retentiona at 60 °C, 1-year Service Life.</span><br><span class="line">a. Indicates how long the battery can hold data <span class="keyword">in</span> the controller<span class="string">&#x27;s memory in case of accidental system shutdown.</span></span><br><span class="line"><span class="string">1 12 hours of retention at 45 °C, 5-year Service Life, transparent learn.b</span></span><br><span class="line"><span class="string">b. The controller&#x27;</span>s performance is not affected during the battery<span class="string">&#x27;s learn cycle.</span></span><br><span class="line"><span class="string">2 12 hours of retention at 55 °C, 3-year Service Life, transparent learn.</span></span><br><span class="line"><span class="string">3 24 hours of retention at 45 °C, 3-year Service Life, transparent learn.</span></span><br><span class="line"><span class="string">4 48 hours of retention at 45 °C, 3-year Service Life.</span></span><br><span class="line"><span class="string">5 48 hours of retention at 55 °C, 1-year Service Life.</span></span><br><span class="line"><span class="string">6 Same as the description for BBU mode 5. The BBU mode 6 enables you to receive events when the battery capacity reaches suboptimal and critical thresholds.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">$ storcli /cx bbu set autolearnmode=&lt;value&gt;</span></span><br><span class="line"><span class="string">where x= 0 – Enabled, 1 – Disabled, 2 – Warn though event.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">## Manual learn battery</span></span><br><span class="line"><span class="string">$ storcli /c0/bbu start learn</span></span><br></pre></td></tr></table></figure>

<h4 id="Cachevault"><a href="#Cachevault" class="headerlink" title="Cachevault"></a><a target="_blank" rel="noopener" href="https://www.thomas-krenn.com/en/wiki/CacheVault_Flash_Cache">Cachevault</a></h4><p>Here is not install cachevalut, all FLASH devices don’t need it, because fastpath need writethrough mode</p>
<p>No battery is used with CacheVault technology. The cache content is protected by the following systems:</p>
<ul>
<li>A double-layer capacitor is connected to the RAID controller.</li>
<li>This will be fully loaded automatically during server startup.</li>
<li>In case of power failure the RAID controller uses the power of the capacitor to write the Flash-Memory to maintain all contents of the cache non-volatile (almost like a USB stick).</li>
<li>The next time the server is started the RAID controller writes the data from the Flash-Memory to the RAID Array.</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$ storcli64 /c0/cv show</span><br><span class="line">Controller = 0</span><br><span class="line">Status = Failure</span><br><span class="line">Description = None</span><br><span class="line"></span><br><span class="line">Detailed Status :</span><br><span class="line">===============</span><br><span class="line"></span><br><span class="line">----------------------------------------------------</span><br><span class="line">Ctrl Status Property ErrMsg                   ErrCd</span><br><span class="line">----------------------------------------------------</span><br><span class="line">   0 Failed -        Cachevault doesn<span class="string">&#x27;t exist   255</span></span><br><span class="line"><span class="string">----------------------------------------------------</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">$ storcli64 /c0/cv show all</span></span><br><span class="line"><span class="string">$ storcli64 /c0/cv show learn</span></span><br><span class="line"><span class="string">$ storcli64 /c0/cv show status</span></span><br><span class="line"><span class="string">$ storcli64 /c0/cv start learn</span></span><br></pre></td></tr></table></figure>

<h4 id="Get-all-megaraid-log-not-filter"><a href="#Get-all-megaraid-log-not-filter" class="headerlink" title="Get all megaraid log, not filter"></a>Get all megaraid log, not filter</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#shows the history of log files generated</span></span><br><span class="line">$ storcli64  /call show eventloginfo file=logfile</span><br><span class="line">$ MegaCli64 -AdpEventLog -GetEvents -f logfile -aALL</span><br><span class="line"></span><br><span class="line"><span class="comment">#prints the system log</span></span><br><span class="line">$ storcli64 /c0 show events file=megaraid_events.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># shows the firmware logs</span></span><br><span class="line">$ storcli64 /c0 show termlog</span><br><span class="line">$ storcli64 /c0 show termlog <span class="built_in">type</span>=config</span><br><span class="line">$ storcli64 /c0 show termlog <span class="built_in">type</span>=contents</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="Show-raid-logic-info"><a href="#Show-raid-logic-info" class="headerlink" title="Show raid logic info"></a>Show raid logic info</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ storcli64 /cx/dall show [all]</span><br><span class="line">$ MegaCli64 -cfgdsply -aALL</span><br></pre></td></tr></table></figure>

<h4 id="Import-license"><a href="#Import-license" class="headerlink" title="Import license"></a>Import license</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ storcli /c0 <span class="built_in">set</span> aso key=xxxxxxxxx</span><br></pre></td></tr></table></figure>

<h4 id="Backup-config"><a href="#Backup-config" class="headerlink" title="Backup config"></a>Backup config</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ MegaCli -CfgSave -f filename -aN</span><br><span class="line">$ MegaCli -CfgRestore -f filename -aN</span><br><span class="line"></span><br><span class="line">$ storcli64 /c0 <span class="built_in">set</span> config file=raid_adapter0.config</span><br><span class="line">$ storcli64 /c0 get config file=raid_adapter0.config</span><br></pre></td></tr></table></figure>

<h4 id="Interrupt-BGI"><a href="#Interrupt-BGI" class="headerlink" title="Interrupt BGI"></a>Interrupt BGI</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ MegaCli64 -LDBI -Abort -LALL -aALL</span><br><span class="line">$ storcli64 /call/vall <span class="built_in">set</span> autobgi=On|Off</span><br><span class="line">$ storcli64 /call/vall show autobgi</span><br><span class="line">$ storcli64 /call/vall stop bgi</span><br><span class="line">$ storcli64 /call/vall pause bgi</span><br><span class="line">$ storcli64 /call/vall resume bgi</span><br><span class="line">$ storcli64 /call/vall show bgi</span><br><span class="line">$ storcli64 /call <span class="built_in">set</span> bgirate=90</span><br></pre></td></tr></table></figure>

<h4 id="Rebuild-x2F-Migrate-x2F-init"><a href="#Rebuild-x2F-Migrate-x2F-init" class="headerlink" title="Rebuild&#x2F;Migrate&#x2F;init"></a>Rebuild&#x2F;Migrate&#x2F;init</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">$ MegaCli64  -AdpSetProp RebuildRate 50 -a0</span><br><span class="line">$ storcli64 /call <span class="built_in">set</span> rebuildrate=50</span><br><span class="line"></span><br><span class="line">$ MegaCli64  -AdpSetProp ReconRate 50 -a0</span><br><span class="line">$ /opt/MegaRAID/MegaCli/MegaCli64 -LDRecon ShowProg L1  -a0</span><br><span class="line">$ storcli64 /call <span class="built_in">set</span> migraterate=50</span><br><span class="line">$ storcli /c0/v1 show migrate</span><br><span class="line">$ storcli /c0/v1 start migrate <span class="built_in">type</span>=raidx</span><br><span class="line"></span><br><span class="line"><span class="comment">#  automatic background initialization</span></span><br><span class="line">$ /opt/MegaRAID/MegaCli/MegaCli64 -LDBI -ShowProg -LALL -aALL</span><br><span class="line">$ storcli /call/vall <span class="built_in">set</span> autobgi=on</span><br><span class="line">$ storcli /call/vall show autobgi</span><br><span class="line">$ storcli /call/vall stop bgi</span><br><span class="line">$ storcli /call/vall resume bgi</span><br><span class="line">$ storcli /call/vall show bgi</span><br><span class="line"></span><br><span class="line"><span class="comment"># virtual drive initialization</span></span><br><span class="line">$ /opt/MegaRAID/MegaCli/MegaCli64 -LDInit ShowProg Lall a0</span><br><span class="line">$ storcli /c0/vall start init</span><br><span class="line">$ storcli /c0/vall stop init</span><br><span class="line">$ storcli /c0/vall show init</span><br></pre></td></tr></table></figure>

<h4 id="Make-device-good"><a href="#Make-device-good" class="headerlink" title="Make device good"></a>Make device good</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ MegaCli64 -PDMakeGood -PhysDrv[20:12] -a0</span><br><span class="line">$ storcli64 /c0/e20/s12 <span class="built_in">set</span> good force</span><br></pre></td></tr></table></figure>

<h4 id="Make-JBOD"><a href="#Make-JBOD" class="headerlink" title="Make JBOD"></a>Make JBOD</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ MegaCli64 -PDMakeJBOD -PhysDrv[E0:S0,E1:S1,...] -aN|-a0,1,2|-aALL</span><br><span class="line">$ storcli64 /c0/e20/s12 <span class="built_in">set</span> jbod (default on)</span><br><span class="line">$ storcli64 /c0 <span class="built_in">set</span> jbod = on/off</span><br><span class="line"></span><br><span class="line">$ MegaCli -AdpSetProp -EnableJBOD -val -aN|-a0,1,2|-aALL</span><br><span class="line">      val - 0=Disable JBOD mode.</span><br><span class="line">            1=Enable JBOD mode.</span><br><span class="line"></span><br><span class="line">$ storcli64 /c0 <span class="built_in">set</span> jbod=on</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="Foreign-devices"><a href="#Foreign-devices" class="headerlink" title="Foreign devices"></a>Foreign devices</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ MegaCli64  -CfgForeign -Clear -aALL</span><br><span class="line">$ storcli64 /c0/fall del|delete</span><br><span class="line"></span><br><span class="line">$ storcli64 /c0/fall show</span><br><span class="line">$ storcli64 /c0/fall import</span><br></pre></td></tr></table></figure>

<h4 id="About-Consistency-and-patrol-read"><a href="#About-Consistency-and-patrol-read" class="headerlink" title="About Consistency and patrol read"></a><a target="_blank" rel="noopener" href="https://www.digiliant.com/docs/MegaRAID-SAS-Software-User-Guide-12Gbs.pdf">About Consistency and patrol read</a></h4><h5 id="Patrol-read"><a href="#Patrol-read" class="headerlink" title="Patrol read"></a>Patrol read</h5><p>Patrol read involves the review of your system for possible drive errors that could lead to drive failure and then action to correct errors. The goal is to protect data integrity by detecting drive failure before the failure can damage data. The corrective actions depend on the drive group configuration and the type of errors.<br>Patrol read starts only when the controller is idle for a defined period of time and no other background tasks are active, though it can continue to run during heavy I&#x2F;O processes.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">$ storcli64 /c0 show patrolRead</span><br><span class="line">Controller = 0</span><br><span class="line">Status = Success</span><br><span class="line">Description = None</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Controller Properties :</span><br><span class="line">=====================</span><br><span class="line"></span><br><span class="line">---------------------------------------------</span><br><span class="line">Ctrl_Prop               Value</span><br><span class="line">---------------------------------------------</span><br><span class="line">PR Mode                 Auto</span><br><span class="line">PR Execution Delay      168 hours</span><br><span class="line">PR iterations completed 0</span><br><span class="line">PR Next Start time      08/24/2019, 03:00:00</span><br><span class="line">PR on SSD               Disabled</span><br><span class="line">PR on EPD               Disabled</span><br><span class="line">PR Current State        Stopped</span><br><span class="line">---------------------------------------------</span><br><span class="line"><span class="comment"># mode=auto/manual</span></span><br><span class="line">$ storcli64 /call <span class="built_in">set</span> patrolread=on mode=auto includessds=on maxconcurrentpd=255 delay=360 <span class="comment">#255 phy devs ,360 housr(15days)</span></span><br><span class="line">$ storcli64 /call <span class="built_in">set</span> patrolread=on mode=auto starttime=2019/08/24 03</span><br><span class="line">$ storcli64 /call <span class="built_in">set</span> patrolread=off</span><br><span class="line"></span><br><span class="line"><span class="comment">##show/stop/start/resume/pause</span></span><br><span class="line">$ storcli64 /call start patrolRead</span><br><span class="line">$ storcli64 /call show patrolRead</span><br><span class="line">Controller = 0</span><br><span class="line">Status = Success</span><br><span class="line">Description = None</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Controller Properties :</span><br><span class="line">=====================</span><br><span class="line"></span><br><span class="line">----------------------------------</span><br><span class="line">Ctrl_Prop               Value</span><br><span class="line">----------------------------------</span><br><span class="line">PR Mode                 Auto</span><br><span class="line">PR Execution Delay      360 hours</span><br><span class="line">PR iterations completed 352</span><br><span class="line">PR on SSD               Enabled</span><br><span class="line">PR Current State        Stopped</span><br><span class="line">----------------------------------</span><br><span class="line"></span><br><span class="line">$ storcli64 /call show prrate</span><br><span class="line">$ storcli64 /call <span class="built_in">set</span> prrate=40</span><br></pre></td></tr></table></figure>

<h4 id="Consistency-Check"><a href="#Consistency-Check" class="headerlink" title="Consistency Check"></a>Consistency Check</h4><p>checking consistency means calculating the data on one drive and comparing the results to the contents of the parity drive<br>It is recommended that you perform a consistency check at least once a month.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line">$ storcli64 /c0 show cc</span><br><span class="line">Controller = 0</span><br><span class="line">Status = Success</span><br><span class="line">Description = None</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Controller Properties :</span><br><span class="line">=====================</span><br><span class="line"></span><br><span class="line">-----------------------------------------------</span><br><span class="line">Ctrl_Prop                 Value</span><br><span class="line">-----------------------------------------------</span><br><span class="line">CC Operation Mode         Concurrent</span><br><span class="line">CC Execution Delay        168</span><br><span class="line">CC Next Starttime         08/24/2019, 02:00:00</span><br><span class="line">CC Current State          Stopped</span><br><span class="line">CC Number of iterations   311</span><br><span class="line">CC Number of VD completed 2</span><br><span class="line">CC Excluded VDs           None</span><br><span class="line">-----------------------------------------------</span><br><span class="line"></span><br><span class="line">$ storcli64 /call show ccrate</span><br><span class="line">$ storcli64 /call <span class="built_in">set</span> ccrate=50</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#schedule</span></span><br><span class="line">$ storcli64 /call/vall <span class="built_in">set</span> cc=<span class="built_in">seq</span></span><br><span class="line">$ storcli64 /call <span class="built_in">set</span> cc=<span class="built_in">seq</span> starttime=2019/08/31 02 delay=1440  <span class="comment">## check interval 1440 hours ,60 days</span></span><br><span class="line">Controller = 0</span><br><span class="line">Status = Success</span><br><span class="line">Description = None</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Controller Properties :</span><br><span class="line">=====================</span><br><span class="line"></span><br><span class="line">---------------------------------</span><br><span class="line">Ctrl_Prop    Value</span><br><span class="line">---------------------------------</span><br><span class="line">CC Mode      SEQ</span><br><span class="line">CC Starttime 2019/08/31 02:00:00</span><br><span class="line">CC delay     1440</span><br><span class="line">---------------------------------</span><br><span class="line"></span><br><span class="line"><span class="comment">#if I &#x27;m not set start time</span></span><br><span class="line">$ storcli64 /call <span class="built_in">set</span> cc=<span class="built_in">seq</span> delay=1440</span><br><span class="line">Controller = 0</span><br><span class="line">Status = Success</span><br><span class="line">Description = None</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Controller Properties :</span><br><span class="line">=====================</span><br><span class="line"></span><br><span class="line">----------------</span><br><span class="line">Ctrl_Prop Value</span><br><span class="line">----------------</span><br><span class="line">CC Mode   SEQ</span><br><span class="line">CC delay  1440</span><br><span class="line">----------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$ storcli64 /c0 show cc</span><br><span class="line">CC Operation Mode         Sequential</span><br><span class="line">CC Execution Delay        1440</span><br><span class="line">CC Next Starttime         08/24/2019, 03:00:00 <span class="comment">## first start after about 12 hours</span></span><br><span class="line">CC Current State          Stopped</span><br><span class="line">CC Number of iterations   120</span><br><span class="line">CC Number of VD completed 1</span><br><span class="line">CC Excluded VDs           None</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">### show again</span></span><br><span class="line">$ storcli64 /c0 show cc</span><br><span class="line">Controller = 0</span><br><span class="line">Status = Success</span><br><span class="line">Description = None</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Controller Properties :</span><br><span class="line">=====================</span><br><span class="line"></span><br><span class="line">-----------------------------------------------</span><br><span class="line">Ctrl_Prop                 Value</span><br><span class="line">-----------------------------------------------</span><br><span class="line">CC Operation Mode         Sequential</span><br><span class="line">CC Execution Delay        1440</span><br><span class="line">CC Next Starttime         08/31/2019, 02:00:00</span><br><span class="line">CC Current State          Stopped</span><br><span class="line">CC Number of iterations   311</span><br><span class="line">CC Number of VD completed 2</span><br><span class="line">CC Excluded VDs           None</span><br><span class="line">-----------------------------------------------</span><br><span class="line"></span><br><span class="line"><span class="comment">#manual start and show status</span></span><br><span class="line"><span class="comment">#show/stop/start/resume/pause</span></span><br><span class="line">$ storcli64 /call/vall start cc [force]</span><br><span class="line">$ storcli64 /call/vall show cc</span><br><span class="line">Controller = 0</span><br><span class="line">Status = Success</span><br><span class="line">Description = None</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">VD Operation Status :</span><br><span class="line">===================</span><br><span class="line"></span><br><span class="line">-----------------------------------</span><br><span class="line">VD Operation Progress% Status</span><br><span class="line">-----------------------------------</span><br><span class="line"> 0 CC                0 In progress</span><br><span class="line"> 1 CC                1 In progress</span><br><span class="line">-----------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$ storcli64 /call/vall stop cc</span><br></pre></td></tr></table></figure>
<h4 id="Montor-cache-ECC-count"><a href="#Montor-cache-ECC-count" class="headerlink" title="Montor cache ECC count"></a>Montor cache ECC count</h4><p>eccbucketleakrate 0 to 65535 Sets the leak rate of the single-bit bucket in minutes (one entry removed per leak-rate).<br>eccbucketsize 0 to 255 Sets the size of ECC single-bit-error bucket (logs event when full).   </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ storcli64 /c0 show all | grep Bucket</span><br><span class="line">ECC Bucket Count = 0</span><br><span class="line">ECC Bucket Size = 255</span><br><span class="line">ECC Bucket Leak Rate (hrs) = 4</span><br></pre></td></tr></table></figure>

<h4 id="About-device-write-cache-in-megaraid"><a href="#About-device-write-cache-in-megaraid" class="headerlink" title="About device write cache in megaraid"></a><a target="_blank" rel="noopener" href="https://utcc.utoronto.ca/~cks/space/blog/tech/ModernDiskWriteCaches">About device write cache in megaraid</a></h4><p>drives can also support a write option called ‘Force Unit Access’ (FUA) that bypasses the write cache in order to force what you’re writing to be forced to disk. In general FUA is bundled with another feature called ‘Disable Page Out’ (DPO), which tells the drive that putting the data into cache is not useful.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">$ Virtual Drives = 2</span><br><span class="line"></span><br><span class="line">VD LIST :</span><br><span class="line">=======</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------</span><br><span class="line">DG/VD TYPE  State Access Consist Cache Cac sCC     Size Name</span><br><span class="line">-------------------------------------------------------------</span><br><span class="line">0/0   RAID1 Optl  RW     Yes     NRWTD -   OFF 223.0 GB R1OS</span><br><span class="line">1/1   RAID5 Optl  RW     Yes     RWTD  -   OFF 1.307 TB</span><br><span class="line">-------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">Cac=CacheCade|Rec=Recovery|OfLn=OffLine|Pdgd=Partially Degraded|dgrd=Degraded</span><br><span class="line">Optl=Optimal|RO=Read Only|RW=Read Write|HD=Hidden|B=Blocked|Consist=Consistent|</span><br><span class="line">R=Read Ahead Always|NR=No Read Ahead|WB=WriteBack|</span><br><span class="line">AWB=Always WriteBack|WT=WriteThrough|C=Cached IO|D=Direct IO|sCC=Scheduled</span><br><span class="line">Check Consistency</span><br><span class="line"></span><br><span class="line">Physical Drives = 6</span><br><span class="line"></span><br><span class="line">PD LIST :</span><br><span class="line">=======</span><br><span class="line"></span><br><span class="line">----------------------------------------------------------------------</span><br><span class="line">EID:Slt DID State DG       Size Intf Med SED PI SeSz Model         Sp</span><br><span class="line">----------------------------------------------------------------------</span><br><span class="line">32:0      0 Onln   0   223.0 GB SATA SSD N   N  512B THNSF8240CCSE U</span><br><span class="line">32:1      1 Onln   0   223.0 GB SATA SSD N   N  512B THNSF8240CCSE U</span><br><span class="line">32:2      2 Onln   1 446.625 GB SATA SSD N   N  512B MTFDDAK480TDC U</span><br><span class="line">32:3      3 Onln   1 446.625 GB SATA SSD N   N  512B MTFDDAK480TDC U</span><br><span class="line">32:4      4 Onln   1 446.625 GB SATA SSD N   N  512B MTFDDAK480TDC U</span><br><span class="line">32:5      5 Onln   1 446.625 GB SATA SSD N   N  512B MTFDDAK480TDC U</span><br><span class="line">----------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">$ dmesg -T | grep DPO</span><br><span class="line">[Tue Nov  5 23:21:47 2019] sd 0:2:1:0: [sdb] Write cache: disabled, <span class="built_in">read</span> cache: enabled, supports DPO and FUA</span><br><span class="line">[Tue Nov  5 23:21:47 2019] sd 0:2:0:0: [sda] Write cache: disabled, <span class="built_in">read</span> cache: disabled, supports DPO and FUA</span><br><span class="line"></span><br><span class="line">$ perccli64 /c0/vall <span class="built_in">set</span> wrcache=WT rdcache=nora iopolicy=direct</span><br><span class="line">Controller = 0</span><br><span class="line">Status = Success</span><br><span class="line">Description = None</span><br><span class="line"></span><br><span class="line">Detailed Status :</span><br><span class="line">===============</span><br><span class="line"></span><br><span class="line">----------------------------------------</span><br><span class="line">VD Property Value  Status  ErrCd ErrMsg</span><br><span class="line">----------------------------------------</span><br><span class="line"> 0 wrCache  WT     Success     0 -</span><br><span class="line"> 0 rdCache  NoRA   Success     0 -</span><br><span class="line"> 0 IoPolicy Direct Success     0 -</span><br><span class="line"> 1 wrCache  WT     Success     0 -</span><br><span class="line"> 1 rdCache  NoRA   Success     0 -</span><br><span class="line"> 1 IoPolicy Direct Success     0 -</span><br><span class="line">----------------------------------------</span><br><span class="line"></span><br><span class="line">$ reboot</span><br><span class="line"></span><br><span class="line">$ dmesg -T | grep DPO</span><br><span class="line">[Thu Nov  7 02:37:51 2019] sd 0:2:0:0: [sda] Write cache: disabled, <span class="built_in">read</span> cache: disabled, supports DPO and FUA</span><br><span class="line">[Thu Nov  7 02:37:51 2019] sd 0:2:1:0: [sdb] Write cache: disabled, <span class="built_in">read</span> cache: disabled, supports DPO and FUA</span><br><span class="line"></span><br><span class="line">Supported VD Operations :</span><br><span class="line">=======================</span><br><span class="line">Read Policy = Yes</span><br><span class="line">Write Policy = Yes</span><br><span class="line">IO Policy = Yes</span><br><span class="line">Access Policy = Yes</span><br><span class="line">Disk Cache Policy = Yes</span><br><span class="line"></span><br><span class="line">$ perccli64 /c0/v0 <span class="built_in">set</span> wrcache=WB</span><br><span class="line">VD Property Value Status  ErrCd ErrMsg</span><br><span class="line">---------------------------------------</span><br><span class="line"> 0 wrCache  WB    Success     0 -</span><br><span class="line">---------------------------------------</span><br><span class="line"></span><br><span class="line">$ reboot</span><br><span class="line"></span><br><span class="line">$  dmesg -T | grep DPO</span><br><span class="line">[Thu Nov  7 02:53:00 2019] sd 0:2:0:0: [sda] Write cache: disabled, <span class="built_in">read</span> cache: disabled, doesn<span class="string">&#x27;t support DPO or FUA</span></span><br><span class="line"><span class="string">[Thu Nov  7 02:53:00 2019] sd 0:2:1:0: [sdb] Write cache: disabled, read cache: disabled, supports DPO and FUA</span></span><br></pre></td></tr></table></figure>
<p>You could change megaraid cache policy, let the device support DPO and FUA    </p>
<h4 id="Flush-RAID-write-cache"><a href="#Flush-RAID-write-cache" class="headerlink" title="Flush RAID write cache"></a>Flush RAID write cache</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#Cache Flush on Selected Controller</span><br><span class="line">$ MegaCli64 –AdpCacheFlush -aN|-a0,1,2|-aALL</span><br><span class="line">$ storcli64 /c0 set flushwriteverify=on</span><br><span class="line">$ storcli64 /c0 show flushwriteverify</span><br><span class="line">$ storcli64 /c0 flushcache</span><br><span class="line"></span><br><span class="line">$ perccli64 /c0 flushcache</span><br><span class="line">Controller = 0</span><br><span class="line">Status = Success</span><br><span class="line">Description = Adapter and/or disk caches flushed successfully.</span><br><span class="line"></span><br><span class="line"># delete the preserved cache for a particular virtual driver on the controller in missing state</span><br><span class="line">$ perccli64 /c0/v1 delete preservedCache</span><br><span class="line">$ storcli64 /c0/v1 delete preservedCache force</span><br><span class="line"></span><br><span class="line">$ storcli64 /c0 show preservedCache</span><br><span class="line">Controller = 0</span><br><span class="line">Status = Success</span><br><span class="line">Description = No Virtual Drive has Preserved Cache Data.</span><br></pre></td></tr></table></figure>
<h4 id="show-PHY"><a href="#show-PHY" class="headerlink" title="show PHY"></a>show PHY</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">$ storcli /cx/px|pall <span class="built_in">set</span> linkspeed=0(auto)|1.5|3|6|12</span><br><span class="line">$ perccli64 /c0/pall show</span><br><span class="line">Controller = 0</span><br><span class="line">Status = Success</span><br><span class="line">Description = None</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PhyInfo :</span><br><span class="line">=======</span><br><span class="line"></span><br><span class="line">-----------------------------------------------------------------------------</span><br><span class="line">PhyNo SAS_Addr           Phy_Identifier Link_Speed Device_Type   Description</span><br><span class="line">-----------------------------------------------------------------------------</span><br><span class="line">    0 0x500056B3BECB2FFF             17 No <span class="built_in">limit</span>   Edge Expander -</span><br><span class="line">    1 0x500056B3BECB2FFF             20 No <span class="built_in">limit</span>   Edge Expander -</span><br><span class="line">    2 0x500056B3BECB2FFF             18 No <span class="built_in">limit</span>   Edge Expander -</span><br><span class="line">    3 0x500056B3BECB2FFF             23 No <span class="built_in">limit</span>   Edge Expander -</span><br><span class="line">    4 0x500056B3BECB2FFF             19 No <span class="built_in">limit</span>   Edge Expander -</span><br><span class="line">    5 0x500056B3BECB2FFF             21 No <span class="built_in">limit</span>   Edge Expander -</span><br><span class="line">    6 0x500056B3BECB2FFF             16 No <span class="built_in">limit</span>   Edge Expander -</span><br><span class="line">    7 0x500056B3BECB2FFF             22 No <span class="built_in">limit</span>   Edge Expander -</span><br><span class="line">-----------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">$ perccli64 /call/eall show</span><br><span class="line">Controller = 0</span><br><span class="line">Status = Success</span><br><span class="line">Description = None</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Properties :</span><br><span class="line">==========</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------------</span><br><span class="line">EID State Slots PD PS Fans TSs Alms SIM Port<span class="comment"># ProdID VendorSpecific</span></span><br><span class="line">--------------------------------------------------------------------</span><br><span class="line"> 32 OK        8  6  0    0   0    0   0 00 x1 BP14G+  !   ?</span><br><span class="line">--------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">EID-Enclosure Device ID |PD-Physical drive count |PS-Power Supply count|</span><br><span class="line">TSs-Temperature sensor count |Alms-Alarm count |SIM-SIM Count</span><br><span class="line"></span><br><span class="line">$ perccli64 /call/eall show status</span><br><span class="line">Controller = 0</span><br><span class="line">Status = Success</span><br><span class="line">Description = None</span><br><span class="line"></span><br><span class="line"><span class="comment"># upgrade the enclosure</span></span><br><span class="line">$ storcli64 /c0/e32 download src=enclosure_fw.bin</span><br></pre></td></tr></table></figure>

<h3 id="Foreign-configurations"><a href="#Foreign-configurations" class="headerlink" title="Foreign configurations"></a>Foreign configurations</h3><p>NOTE Provide the security key when importing a locked foreign configuration created in a different machine that is encrypted with a security key.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ perccli64 /c0/fall show</span><br><span class="line">Controller = 0</span><br><span class="line">Status = Success</span><br><span class="line">Description = Couldn<span class="string">&#x27;t find any foreign Configuration</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">$ storcli64 /c0/fall import</span></span><br><span class="line"><span class="string">$ storcli64 /cx/fx|fall show [all][ securitykey=sssssssssss ]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#This command deletes the foreign configuration of a controller.</span></span><br><span class="line"><span class="string">$ ### storcli64 /c0/fall delete</span></span><br></pre></td></tr></table></figure>
<h4 id="Dimmer-switch"><a href="#Dimmer-switch" class="headerlink" title="Dimmer switch"></a>Dimmer switch</h4><p>The Dimmer Switch is the power-saving policy for the virtual drive</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">$ perccli64 /c0 show ds</span><br><span class="line">Controller = 0</span><br><span class="line">Status = Success</span><br><span class="line">Description = None</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Controller Properties :</span><br><span class="line">=====================</span><br><span class="line"></span><br><span class="line">-------------------------------</span><br><span class="line">Ctrl_Prop         Value</span><br><span class="line">-------------------------------</span><br><span class="line">SpnDwnUncDrv      Disabled</span><br><span class="line">SpnDwnHS          Disabled</span><br><span class="line">SpnDwnTm          30 minute(s)</span><br><span class="line">SpnDwnCfgDrv      Disabled</span><br><span class="line">DefaultLdPSPolicy None</span><br><span class="line">DsblLdPsInterval  0 hours</span><br><span class="line">DsblLdPsTime      0 minutes</span><br><span class="line">SpnUpEncDly       8 second(s)</span><br><span class="line">spinUpEncDrvCnt   6</span><br><span class="line">-------------------------------</span><br><span class="line"></span><br><span class="line">$ storcli /cx/vx <span class="built_in">set</span> ds=default | auto | none | max | maxnocache</span><br><span class="line">auto: Logical device power savings are managed by the firmware.</span><br><span class="line">none: No power saving policy.</span><br><span class="line">max: Logical device uses maximum power savings.</span><br><span class="line">maxnocache: Logical device does not cache write to maximise power savings.</span><br><span class="line"></span><br><span class="line">$ storcli64  /c0 <span class="built_in">set</span> ds=on <span class="built_in">type</span>=1|2</span><br><span class="line">1: Unconfigured</span><br><span class="line">2: Hot spare</span><br><span class="line">3: Virtual drive</span><br><span class="line">4: All</span><br><span class="line"></span><br><span class="line">$ storcli /cx <span class="built_in">set</span> ds=on [properties]</span><br><span class="line">disableldps: Interval <span class="keyword">in</span> hours or time <span class="keyword">in</span> hh:mm format</span><br><span class="line">spinupdrivecount: Valid enclosure number (0 to 255)</span><br><span class="line">SpinUpEncDelay: Valid time <span class="keyword">in</span> seconds</span><br></pre></td></tr></table></figure>

<h3 id="Device"><a href="#Device" class="headerlink" title="Device"></a>Device</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ storcli64 /cx[/ex]/sx spindown</span><br><span class="line">$ storcli64 /cx[/ex]/sx spinup</span><br><span class="line"></span><br><span class="line">$ storcli64 /cx[/ex]/sx secureerase [force]</span><br><span class="line">$ storcli64 /cx[/ex]/sx start erase [simple|normal|thorough] [erasepatternA=&lt;value1&gt;] [erasepatternB=&lt;value2&gt;]</span><br><span class="line">$ storcli64 /cx[/ex]/sx stop erase</span><br></pre></td></tr></table></figure>

<h4 id="debug"><a href="#debug" class="headerlink" title="debug"></a>debug</h4><h5 id="log"><a href="#log" class="headerlink" title="log"></a>log</h5><p>— 0 – NA<br>— 1– SET<br>— 2 – CLEAR<br>— 3 – CLEAR ALL<br>— 4 – DEBUG DUMP</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ storcli64 /call show all logfile=megaraid.cfg</span><br><span class="line">$ storcli64 /c x <span class="built_in">set</span> debug reset all</span><br><span class="line">$ storcli64 /call x <span class="built_in">set</span> debug <span class="built_in">type</span> = &lt;value&gt; option = &lt;value&gt; level = [&lt;value <span class="keyword">in</span> hex&gt;]</span><br><span class="line"><span class="comment">#type – takes the value from 0 – 128, mapping each number to a particular debug variable in the firmware.</span></span><br><span class="line">$ <span class="comment">#storcli64 /call delete events</span></span><br><span class="line">$ <span class="comment">#storcli64 /call delete termlog</span></span><br><span class="line"></span><br><span class="line">$ storcli64 /call show events file=events.log</span><br><span class="line">$ storcli64 /call show termlog <span class="built_in">type</span>=config logfile=termlog.config</span><br><span class="line">$ storcli64 /call show termlog <span class="built_in">type</span>=contents logfile=termlog.contents</span><br><span class="line">$ storcli64 /call show eventloginfo logfile=event.info</span><br><span class="line">$ storcli64 /call show dequeuelog file=dequeue.log</span><br><span class="line">$ storcli64 /call show alilog logfile=ali.log</span><br></pre></td></tr></table></figure>
<h5 id="Encolsure"><a href="#Encolsure" class="headerlink" title="Encolsure"></a>Encolsure</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ perccli64 /call/eall download src=encolsure.bin</span><br><span class="line">$ perccli64 /call/eall show all</span><br><span class="line">$ perccli64 /call/eall show status</span><br></pre></td></tr></table></figure>

<h5 id="phy-err"><a href="#phy-err" class="headerlink" title="phy err"></a>phy err</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">storcli /cx/px|pall show</span><br><span class="line">storcli /cx/px|pall show all</span><br><span class="line">storcli /cx/ex show phyerrorcounters</span><br><span class="line">storcli /cx[/ex]/sx show phyerrorcounters</span><br><span class="line">storcli /cx[/ex]/sx reset phyerrorcounters</span><br><span class="line">storcli /cx/px|pall <span class="built_in">set</span> linkspeed=0(auto)|1.5|3|6|12</span><br></pre></td></tr></table></figure>

<h4 id="diag-adapter"><a href="#diag-adapter" class="headerlink" title="diag adapter"></a>diag adapter</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ perccli64 /c0 start diag duration=10 logfile=diag.log</span><br></pre></td></tr></table></figure>

<h4 id="Enable-SEP-for-Dell-PERC"><a href="#Enable-SEP-for-Dell-PERC" class="headerlink" title="Enable SEP for Dell PERC"></a>Enable SEP for Dell PERC</h4><p>Configures enclosure detection on a non-SES&#x2F;expander backplane.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ perccli64 /call <span class="built_in">set</span> backplane mode=0 expose=on</span><br><span class="line">0: Use autodetect logic of backplanes, such as SGPIO and I2C SEP using GPIO pins.</span><br><span class="line">1: Disable autodetect SGPIO.</span><br><span class="line">2: Disable I2C SEP autodetect.</span><br><span class="line">3: Disable both the autodetects.</span><br><span class="line"></span><br><span class="line">backplane expose: Enables or disables device drivers to expose enclosure devices; <span class="keyword">for</span> example, expanders, SEPs.</span><br><span class="line"></span><br><span class="line">$ perccli64 /call <span class="built_in">set</span> sesmonitoring=on</span><br></pre></td></tr></table></figure>
<h4 id="Enable-JBOD"><a href="#Enable-JBOD" class="headerlink" title="Enable JBOD"></a>Enable JBOD</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ storcli64 /call <span class="built_in">set</span> jbod=on</span><br></pre></td></tr></table></figure>

<h4 id="SAS-loading-balance"><a href="#SAS-loading-balance" class="headerlink" title="SAS loading balance"></a>SAS loading balance</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ storcli64 /cx <span class="built_in">set</span> loadbalancemode=on</span><br></pre></td></tr></table></figure>
<h4 id="Driver-performance"><a href="#Driver-performance" class="headerlink" title="Driver performance"></a>Driver performance</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ storcli64 /call <span class="built_in">set</span> DPM=on</span><br><span class="line"><span class="comment">#Enables or disables drive performance monitoring</span></span><br><span class="line"></span><br><span class="line">$ storcli64 /call <span class="built_in">set</span> ncq=on</span><br><span class="line">$ storcli64 /call <span class="built_in">set</span> perfmode=1 <span class="comment">#default was 0</span></span><br><span class="line">0: Tuned to provide best IOPS, currently applicable to non-FastPath</span><br><span class="line">1: Tuned to provide least latency, currently applicable to non-FastPath</span><br></pre></td></tr></table></figure>

<h4 id="Get-smart-info-from-LSI-megaraid"><a href="#Get-smart-info-from-LSI-megaraid" class="headerlink" title="Get smart info from LSI megaraid"></a>Get smart info from LSI megaraid</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">$ smartctl -s on -a -d megaraid,1 /dev/sda -T permissive</span><br><span class="line">$ smartctl -s on -a -d megaraid,0 /dev/sda -T permissive</span><br><span class="line">smartctl 6.5 2016-05-07 r4318 [x86_64-linux-3.10.0-957.1.3.el7.x86_64] (<span class="built_in">local</span> build)</span><br><span class="line">Copyright (C) 2002-16, Bruce Allen, Christian Franke, www.smartmontools.org</span><br><span class="line"></span><br><span class="line">=== START OF INFORMATION SECTION ===</span><br><span class="line">Vendor:               HGST</span><br><span class="line">Product:              HUSMM1616ASS204</span><br><span class="line">Revision:             L380</span><br><span class="line">Compliance:           SPC-4</span><br><span class="line">User Capacity:        1,600,321,314,816 bytes [1.60 TB]</span><br><span class="line">Logical block size:   512 bytes</span><br><span class="line">LU is resource provisioned, LBPRZ=1</span><br><span class="line">Rotation Rate:        Solid State Device</span><br><span class="line">Form Factor:          2.5 inches</span><br><span class="line">Logical Unit <span class="built_in">id</span>:      0x0000000000000000</span><br><span class="line">Serial number:        0000000</span><br><span class="line">Device <span class="built_in">type</span>:          disk</span><br><span class="line">Transport protocol:   SAS (SPL-3)</span><br><span class="line">Local Time is:        Thu Dec 27 15:44:50 2018 CST</span><br><span class="line">SMART support is:     Available - device has SMART capability.</span><br><span class="line">SMART support is:     Enabled</span><br><span class="line">Temperature Warning:  Disabled or Not Supported</span><br><span class="line"></span><br><span class="line">=== START OF ENABLE/DISABLE COMMANDS SECTION ===</span><br><span class="line">Informational Exceptions (SMART) enabled</span><br><span class="line">Temperature warning enabled</span><br><span class="line"></span><br><span class="line">=== START OF READ SMART DATA SECTION ===</span><br><span class="line">SMART Health Status: OK</span><br><span class="line"></span><br><span class="line">Percentage used endurance indicator: 0%</span><br><span class="line">Current Drive Temperature:     32 C</span><br><span class="line">Drive Trip Temperature:        60 C</span><br><span class="line"></span><br><span class="line">Manufactured <span class="keyword">in</span> week 53 of year 2016</span><br><span class="line">Specified cycle count over device lifetime:  0</span><br><span class="line">Accumulated start-stop cycles:  0</span><br><span class="line">Specified load-unload count over device lifetime:  0</span><br><span class="line">Accumulated load-unload cycles:  0</span><br><span class="line">Vendor (Seagate) cache information</span><br><span class="line">  Blocks sent to initiator = 6325615015755776</span><br><span class="line"></span><br><span class="line">Error counter <span class="built_in">log</span>:</span><br><span class="line">           Errors Corrected by           Total   Correction     Gigabytes    Total</span><br><span class="line">               ECC          rereads/    errors   algorithm      processed    uncorrected</span><br><span class="line"><span class="built_in">read</span>:          0        0         0         0          0       6874.841           0</span><br><span class="line">write:         0        0         0         0          0      10898.936           0</span><br><span class="line">verify:        0        0         0         0          0         32.879           0</span><br><span class="line"></span><br><span class="line">Non-medium error count:        0</span><br></pre></td></tr></table></figure>

<h4 id="performance-monitor"><a href="#performance-monitor" class="headerlink" title="performance monitor"></a>performance monitor</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line">$ perccli64 /c0 show dpm</span><br><span class="line">$ perccli64 /c0 <span class="built_in">set</span> dpm=on</span><br><span class="line"></span><br><span class="line">$ perccli64 /c0 delete dpmstat <span class="built_in">type</span> = Hist | LCT | RA |EXT [logfile=filename]</span><br><span class="line">$ perccli64 /c0 show dpmstat <span class="built_in">type</span> = Hist | LCT | RA |EXT [logfile=filename]</span><br><span class="line">$ storcli64 /c0 start dpm</span><br><span class="line">$ storcli64 /c0 stop dpm</span><br><span class="line"></span><br><span class="line">MR 7.14 storcli64 version</span><br><span class="line">$ storcli64 /c1/e25/sall show dpmstat <span class="built_in">type</span> = HIST logfile=9460-16i_dpmstat_HIST.txt</span><br><span class="line">$ storcli64 /c1/e25/sall show dpmstat <span class="built_in">type</span> = LCT logfile=9460-16i_dpmstat_LCT.txt</span><br><span class="line">$ storcli64 /c1/e25/sall show dpmstat <span class="built_in">type</span> = RA logfile=9460-16i_dpmstat_RA.txt</span><br><span class="line">$ storcli64 /c1/e25/sall show dpmstat <span class="built_in">type</span> = EXT logfile=9460-16i_dpmstat_EXT.txt</span><br><span class="line"></span><br><span class="line">MR 9361-8i use MR 6.14, storcli 1.2.xx</span><br><span class="line">$ storcli64 -DpmStat -Dsply lct -physdrv [10:0] -a0</span><br><span class="line"></span><br><span class="line">Drive Performance Monitor Configuration <span class="keyword">for</span> 0</span><br><span class="line">Performance Monitor: ON</span><br><span class="line">Max commands <span class="keyword">for</span> averaging: 100</span><br><span class="line">Max latency commands to save: 10</span><br><span class="line"></span><br><span class="line">Enclosure Device ID: 32</span><br><span class="line">Slot Number: 0</span><br><span class="line">Device Id: 0</span><br><span class="line">                    Resp</span><br><span class="line">Date    |   Time  | Time(ms) | CDB/ATA Task File(hex)</span><br><span class="line">-----------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">0        0         0.0000    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">0        0         0.0000    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">0        0         0.0000    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">0        0         0.0000    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">0        0         0.0000    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">0        0         0.0000    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">0        0         0.0000    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">0        0         0.0000    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">0        0         0.0000    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">0        0         0.0000    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line"></span><br><span class="line">$ storcli64 -DpmStat -Dsply ra -physdrv [10:0] -a0</span><br><span class="line"></span><br><span class="line">Drive Performance Monitor Configuration <span class="keyword">for</span> 0</span><br><span class="line">Performance Monitor: ON</span><br><span class="line">Max commands <span class="keyword">for</span> averaging: 100</span><br><span class="line">Max latency commands to save: 10</span><br><span class="line">Requested data: Running Average Drive Statistics</span><br><span class="line"></span><br><span class="line">Enclosure   Slot                           Queue      Xfer       Resp</span><br><span class="line">Device ID | Number | Device Id |  IOPs  |  Depth  |   Rate    |  Time</span><br><span class="line">          |        |           |        |         |   (MB/s)  |  (ms)</span><br><span class="line"></span><br><span class="line">32          3        3          0        0         0.0000       0.0000</span><br><span class="line"></span><br><span class="line">$ storcli64 -DpmStat -Dsply hist -physdrv [10:0] -a0</span><br><span class="line">Drive Performance Monitor Configuration <span class="keyword">for</span> 0</span><br><span class="line">Performance Monitor: ON</span><br><span class="line">Max commands <span class="keyword">for</span> averaging: 100</span><br><span class="line">Max latency commands to save: 10</span><br><span class="line"></span><br><span class="line">Enclosure Device ID: 32</span><br><span class="line">Slot Number: 3</span><br><span class="line">Device Id: 3</span><br><span class="line"></span><br><span class="line">------------------------------------------</span><br><span class="line">Bin       Respose Time (ms)   IO Count</span><br><span class="line">------------------------------------------</span><br><span class="line">1         1                   0</span><br><span class="line">2         2                   0</span><br><span class="line">3         3                   0</span><br><span class="line">4         4                   0</span><br><span class="line">5         5                   0</span><br><span class="line">6         6                   0</span><br><span class="line">7         7                   0</span><br><span class="line">8         8                   0</span><br><span class="line">9         9                   0</span><br><span class="line">10        10                  0</span><br><span class="line">11        20                  0</span><br><span class="line">12        30                  0</span><br><span class="line">13        40                  0</span><br><span class="line">14        50                  0</span><br><span class="line">15        60                  0</span><br><span class="line">16        70                  0</span><br><span class="line">17        80                  0</span><br><span class="line">18        90                  0</span><br><span class="line">19        100                 0</span><br><span class="line">20        200                 0</span><br><span class="line">21        300                 0</span><br><span class="line">22        400                 0</span><br><span class="line">23        500                 0</span><br><span class="line">24        600                 0</span><br><span class="line">25        700                 0</span><br><span class="line">26        800                 0</span><br><span class="line">27        900                 0</span><br><span class="line">28        1000                0</span><br><span class="line">29        2000                0</span><br><span class="line">30        3000                0</span><br><span class="line">31        4000                0</span><br><span class="line">32        5000                0</span><br><span class="line">33        6000                0</span><br><span class="line">34        7000                0</span><br><span class="line">35        8000                0</span><br><span class="line">36        9000                0</span><br><span class="line">37        10000               0</span><br><span class="line">38        10000+              0</span><br><span class="line">------------------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$ storcli64 -DpmStat -Dsply ext -physdrv [10:0] -a0</span><br><span class="line">Drive Performance Monitor Configuration <span class="keyword">for</span> 0</span><br><span class="line">Performance Monitor: ON</span><br><span class="line">Max commands <span class="keyword">for</span> averaging: 100</span><br><span class="line">Max latency commands to save: 10</span><br><span class="line"></span><br><span class="line">Enclosure Device ID: 32</span><br><span class="line">Slot Number: 3</span><br><span class="line">Device Id: 3</span><br><span class="line">  Sectors                                      Commands</span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">Read        Write       Write-FUA      Read        Write       Write-FUA  Flush</span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">0           0           0              0           0           0           0</span><br></pre></td></tr></table></figure>

<h3 id="T10-PI-for-megaraid"><a href="#T10-PI-for-megaraid" class="headerlink" title="T10 PI for megaraid"></a>T10 PI for megaraid</h3><p><img src="/img/MegaRAID-setting-1.png"><br><a target="_blank" rel="noopener" href="https://www.broadcom.com/support/knowledgebase/1211161502244/the-data-protection-feature---megaraid">Megaraid T10 PI</a><br>The Data Protection feature is an additional method of preventing data corruption by delivering end-to-end data integrity through the full I&#x2F;O path from the application to the disk drive. This feature is officially called T-10 Protection Information (T-10 PI) and requires special hard drives with 520-byte sectors. The feature is essentially Parity which is done internally on the drives that support T-10 PI.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ perccli64 /cx <span class="built_in">set</span> pi state = off</span><br></pre></td></tr></table></figure>

<h3 id="About-T10-rebuild-assist-for-megaraid"><a href="#About-T10-rebuild-assist-for-megaraid" class="headerlink" title="About T10 rebuild assist for megaraid"></a><a target="_blank" rel="noopener" href="https://www.dell.com/support/article/us/en/04/qna44044/perc9-under-certain-conditions-there-is-a-possible-data-integrity-issue-with-the-rapid-rebuild?lang=en">About T10 rebuild assist for megaraid</a></h3><p><code>Unstable</code></p>
<p>Dell PERC 9 controllers (H330, H730, H730P, and H830) introduced a feature called Rapid Rebuild that speeds up the time to rebuild failed drives in certain conditions. This feature is based on T10 Rebuild Assist. Dell has determined that there is a possibility for data integrity issues when this feature is used under certain conditions.</p>
<p><code>When the PERC is rebuilding the data for the &quot;bad&quot; sectors, it incorrectly writes data from cache to the failed drive instead of the hot spare. This results in data and associated parity not being written to the hot spare. In write through mode, parity errors will occur. In write back mode, errors will occur in both data and associated parity.</code></p>
<p>From the PERC Controller log if you see the below highlighted text you have encountered the issue.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C0:EVT<span class="comment">#395950-08/17/16 13:54:59: 114=State change on PD 0b(e0x20/s11) from OFFLINE(XX) to REBUILDASSIST(12)</span></span><br></pre></td></tr></table></figure>
<p>If you have not encountered this issue then to protect against this scenario please update your PERC H730, H730p, H830 controller firmware to 25.5.0.0018 and PERC H330 controller firmware to 25.5.0.0019 or later firmware which disables the Rapid Rebuild feature.</p>
<h4 id="Enable-T10-data-protection-in-LSI-9380-8e"><a href="#Enable-T10-data-protection-in-LSI-9380-8e" class="headerlink" title="Enable T10-data-protection in LSI 9380-8e"></a>Enable T10-data-protection in LSI 9380-8e</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># make sure the sas device support the feature</span></span><br><span class="line">$ sg_vpd -p ei -l -v /dev/sdc</span><br><span class="line">    inquiry cdb: 12 01 86 00 <span class="built_in">fc</span> 00</span><br><span class="line">    inquiry: pass-through requested 252 bytes but got 64 bytes</span><br><span class="line">    inquiry cdb: 12 00 00 00 24 00</span><br><span class="line">extended INQUIRY data VPD page:</span><br><span class="line">   [PQual=0  Peripheral device <span class="built_in">type</span>: disk]</span><br><span class="line">  ACTIVATE_MICROCODE=1 [before final WRITE BUFFER]</span><br><span class="line"></span><br><span class="line">  SPT=1 [protection types 1 and 2 supported]</span><br><span class="line">...</span><br><span class="line">$ sg_format -v --long --format --size=512 --fmtpinfo=3 --pfu=0 /dev/sdX</span><br><span class="line"><span class="comment"># or you could set to 4K</span></span><br><span class="line">$ sg_format -v --long --format --size=4096 --fmtpinfo=3 --pfu=0 /dev/sdX</span><br><span class="line"></span><br><span class="line"><span class="comment"># first format, show an error</span></span><br><span class="line">    inquiry cdb: 12 00 00 00 24 00</span><br><span class="line">    HGST      HUS724030ALS640   A280   peripheral_type: disk [0x0]</span><br><span class="line">      PROTECT=1</span><br><span class="line">      &lt;&lt; <span class="string">supports protection information&gt;&gt;</span></span><br><span class="line"><span class="string">    mode sense (10) cdb: 5a 10 01 00 00 00 00 00 fc 00</span></span><br><span class="line"><span class="string">mode sense (10):  Fixed format, current;  Sense key: Unit Attention</span></span><br><span class="line"><span class="string"> Additional sense: Mode parameters changed</span></span><br><span class="line"><span class="string">MODE SENSE (10) command, unit attention</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># try second format, it &#x27;s worked</span></span><br><span class="line"><span class="string">    inquiry cdb: 12 00 00 00 24 00</span></span><br><span class="line"><span class="string">    HGST      HUS724030ALS640   A280   peripheral_type: disk [0x0]</span></span><br><span class="line"><span class="string">      PROTECT=1</span></span><br><span class="line"><span class="string">      &lt;&lt; supports</span> protection information&gt;&gt;</span><br><span class="line">    mode sense (10) cdb: 5a 10 01 00 00 00 00 00 <span class="built_in">fc</span> 00</span><br><span class="line">    mode sense (10): pass-through requested 252 bytes but got 36 bytes</span><br><span class="line">Mode Sense (block descriptor) data, prior to changes:</span><br><span class="line">  &lt;&lt;&lt; <span class="string">longlba flag set (64 bit lba) &gt;&gt;&gt;</span></span><br><span class="line"><span class="string">  Number of blocks=5860533168 [0x15d50a3b0]</span></span><br><span class="line"><span class="string">  Block size=512 [0x200]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">A FORMAT will commence in 10 seconds</span></span><br><span class="line"><span class="string">    ALL data on /dev/sds will be DESTROYED</span></span><br><span class="line"><span class="string">        Press control-C to abort</span></span><br><span class="line"><span class="string">A FORMAT will commence in 5 seconds</span></span><br><span class="line"><span class="string">    ALL data on /dev/sds will be DESTROYED</span></span><br><span class="line"><span class="string">        Press control-C to abort</span></span><br><span class="line"><span class="string">    format cdb: 04 d8 00 00 00 00</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">## After format and switch the device to the LSI-9380-8e</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Basics :</span></span><br><span class="line"><span class="string">======</span></span><br><span class="line"><span class="string">Controller = 0</span></span><br><span class="line"><span class="string">Model = AVAGO MegaRAID SAS 9380-8e</span></span><br><span class="line"><span class="string">Serial Number = SV43821663</span></span><br><span class="line"><span class="string">Current Controller Date/Time = 04/30/2020, 03:38:35</span></span><br><span class="line"><span class="string">Current System Date/time = 04/30/2020, 11:38:36</span></span><br><span class="line"><span class="string">SAS Address = 500605b00992b480</span></span><br><span class="line"><span class="string">PCI Address = 00:65:00:00</span></span><br><span class="line"><span class="string">Mfg Date = 09/19/14</span></span><br><span class="line"><span class="string">Rework Date = 00/00/00</span></span><br><span class="line"><span class="string">Revision No = 01C</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Version :</span></span><br><span class="line"><span class="string">=======</span></span><br><span class="line"><span class="string">Firmware Package Build = 24.21.0-0119</span></span><br><span class="line"><span class="string">Firmware Version = 4.680.00-8505</span></span><br><span class="line"><span class="string">CPLD Version = 26611-00A</span></span><br><span class="line"><span class="string">Bios Version = 6.36.00.3_4.19.08.00_0x06180203</span></span><br><span class="line"><span class="string">HII Version = 03.25.05.12</span></span><br><span class="line"><span class="string">Ctrl-R Version = 5.19-0603</span></span><br><span class="line"><span class="string">Preboot CLI Version = 01.07-05:#%0000</span></span><br><span class="line"><span class="string">NVDATA Version = 3.1705.00-0020</span></span><br><span class="line"><span class="string">Boot Block Version = 3.07.00.00-0003</span></span><br><span class="line"><span class="string">Driver Name = megaraid_sas</span></span><br><span class="line"><span class="string">Driver Version = 07.707.50.00-rh1</span></span><br></pre></td></tr></table></figure>



<h4 id="Create-raid-and-enable-T10-pi-data-protection"><a href="#Create-raid-and-enable-T10-pi-data-protection" class="headerlink" title="Create raid and enable T10-pi data protection"></a>Create raid and enable T10-pi data protection</h4><p>you can see PI &#x3D; Y , it ‘s worked.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Add &quot;pi&quot; key word</span></span><br><span class="line">$ storcli64 /c0 add vd <span class="built_in">type</span>=raid5 drives=94:13,15,17 WB pi strip=64</span><br><span class="line">$ storcli64 /c0/v1 show all</span><br><span class="line"></span><br><span class="line">CLI Version = 007.1211.0000.0000 Nov 07, 2019</span><br><span class="line">Operating system = Linux 3.10.0-1062.18.1.el7.x86_64</span><br><span class="line">Controller = 0</span><br><span class="line">Status = Success</span><br><span class="line">Description = None</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/c0/v1 :</span><br><span class="line">======</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------</span><br><span class="line">DG/VD TYPE  State Access Consist Cache Cac sCC     Size Name</span><br><span class="line">-------------------------------------------------------------</span><br><span class="line">1/1   RAID5 Optl  RW     No      RWBD  -   ON  5.457 TB</span><br><span class="line">-------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">EID=Enclosure Device ID| VD=Virtual Drive| DG=Drive Group|Rec=Recovery</span><br><span class="line">Cac=CacheCade|OfLn=OffLine|Pdgd=Partially Degraded|Dgrd=Degraded</span><br><span class="line">Optl=Optimal|RO=Read Only|RW=Read Write|HD=Hidden|TRANS=TransportReady|B=Blocked|</span><br><span class="line">Consist=Consistent|R=Read Ahead Always|NR=No Read Ahead|WB=WriteBack|</span><br><span class="line">AWB=Always WriteBack|WT=WriteThrough|C=Cached IO|D=Direct IO|sCC=Scheduled</span><br><span class="line">Check Consistency</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PDs <span class="keyword">for</span> VD 1 :</span><br><span class="line">============</span><br><span class="line"></span><br><span class="line">----------------------------------------------------------------------------</span><br><span class="line">EID:Slt DID State DG     Size Intf Med SED PI SeSz Model            Sp Type</span><br><span class="line">----------------------------------------------------------------------------</span><br><span class="line">94:13   104 Onln   1 2.728 TB SAS  HDD N   Y  512B HUS724030ALS640  U  -</span><br><span class="line">94:15   107 Onln   1 2.728 TB SAS  HDD N   Y  512B HUS724030ALS640  U  -</span><br><span class="line">94:17   102 Onln   1 2.728 TB SAS  HDD N   Y  512B HUS724030ALS640  U  -</span><br><span class="line">----------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">EID=Enclosure Device ID|Slt=Slot No.|DID=Device ID|DG=DriveGroup</span><br><span class="line">DHS=Dedicated Hot Spare|UGood=Unconfigured Good|GHS=Global Hotspare</span><br><span class="line">UBad=Unconfigured Bad|Onln=Online|Offln=Offline|Intf=Interface</span><br><span class="line">Med=Media Type|SED=Self Encryptive Drive|PI=Protection Info</span><br><span class="line">SeSz=Sector Size|Sp=Spun|U=Up|D=Down|T=Transition|F=Foreign</span><br><span class="line">UGUnsp=UGood Unsupported|UGShld=UnConfigured shielded|HSPShld=Hotspare shielded</span><br><span class="line">CFShld=Configured shielded|Cpybck=CopyBack|CBShld=Copyback Shielded</span><br><span class="line">UBUnsp=UBad Unsupported|Rbld=Rebuild</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>GUI set<br><img src="/img/adapter_support_pi.png"><br><img src="/img/create_r1.png"><br><img src="/img/create_vd_pi.png"><br><img src="/img/4K-pi.png"><br><img src="/img/512B-pi.png"><br><img src="/img/vd_support_pi.png">    </p>
<h4 id="Redhat-support"><a href="#Redhat-support" class="headerlink" title="Redhat support"></a><a target="_blank" rel="noopener" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/storage_administration_guide/ch-install-config">Redhat support</a></h4><p>Block Devices with DIF&#x2F;DIX Enabled<br>DIF&#x2F;DIX is a hardware checksum feature provided by certain SCSI host bus adapters and block devices. When DIF&#x2F;DIX is enabled, error occurs if the block device is used as a general-purpose block device. Buffered I&#x2F;O or mmap(2)-based I&#x2F;O will not work reliably, as there are no interlocks in the buffered write path to prevent buffered data from being overwritten after the DIF&#x2F;DIX checksum has been calculated.<br>This causes the I&#x2F;O to later fail with a checksum error. This problem is common to all block device (or file system-based) buffered I&#x2F;O or mmap(2) I&#x2F;O, so it is not possible to work around these errors caused by overwrites.<br>As such, block devices with DIF&#x2F;DIX enabled should only be used with applications that use O_DIRECT. Such applications should use the raw block device. Alternatively, it is also safe to use the XFS file system on a DIF&#x2F;DIX enabled block device, as long as only O_DIRECT I&#x2F;O is issued through the file system. XFS is the only file system that does not fall back to buffered I&#x2F;O when doing certain allocation operations.<br>The responsibility for ensuring that the I&#x2F;O data does not change after the DIF&#x2F;DIX checksum has been computed always lies with the application, so only applications designed for use with O_DIRECT I&#x2F;O and DIF&#x2F;DIX hardware should use DIF&#x2F;DIX.</p>
<h4 id="Upgrade-LSI-9500"><a href="#Upgrade-LSI-9500" class="headerlink" title="Upgrade LSI 9500"></a>Upgrade LSI 9500</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#upgrade rom</span></span><br><span class="line">$ /opt/MegaRAID/storcli/storcli64 /c1 download bios file=IT_HBA_X64_BIOS_PKG_E6.rom</span><br><span class="line">$ /opt/MegaRAID/storcli/storcli64 /c1 download efibios file=IT_HBA_ARM_UEFI_PKG_E6.rom</span><br><span class="line">Downloading image.Please <span class="built_in">wait</span>...</span><br><span class="line"></span><br><span class="line">CLI Version = 007.2103.0000.0000 Dec 08, 2021</span><br><span class="line">Operating system = Linux 3.10.0-1160.49.1.el7_lustre.x86_64</span><br><span class="line">Controller = 1</span><br><span class="line">Status = Failure</span><br><span class="line">Description = Unsupported flash <span class="built_in">type</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#upgrade firmware</span></span><br><span class="line">$ /opt/MegaRAID/storcli/storcli64 /c1 download file=HBA_9500-16e_Mixed_Profile.bin noverchk</span><br><span class="line">$ /opt/MegaRAID/storcli/storcli64 /c1 download file=HBA_9500-16e_Mixed_Profile.bin</span><br><span class="line">Downloading image.Please <span class="built_in">wait</span>...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CLI Version = 007.2103.0000.0000 Dec 08, 2021</span><br><span class="line">Operating system = Linux 3.10.0-1160.49.1.el7_lustre.x86_64</span><br><span class="line">Controller = 1</span><br><span class="line">Status = Success</span><br><span class="line">Description = CRITICAL! Flash successful. Please power cycle the system <span class="keyword">for</span> the changes to take effect</span><br></pre></td></tr></table></figure>

<p>LSI 9300 upgrade</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sas3flash -c 3 -f /sources/SAS9300_8e_IT.bin -b mpt3x64.rom -noreset</span><br></pre></td></tr></table></figure>

<p>upgrade mpt3sas under linux</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#compile to local</span></span><br><span class="line">$ make -j4 CONFIG_DEBUG_INFO=1 -C /lib/modules/$(<span class="built_in">uname</span> -r)/build M=/lsi-9300-8e/mpt3sas</span><br><span class="line"></span><br><span class="line"><span class="comment">#compile to local kernel</span></span><br><span class="line">$ make -j4 CONFIG_DEBUG_INFO=1 -C /lib/modules/$(<span class="built_in">uname</span> -r)/build M=/lsi-9300-8e/mpt3sas modules_install</span><br></pre></td></tr></table></figure>
<p>mpt3sas driver debug mode   </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line">logging_level:</span><br><span class="line">The logging_level feature prints debug messages of the enabled <span class="built_in">log</span> areas to the kernel message <span class="built_in">log</span> file /var/log/messages. Below is the bit map <span class="keyword">for</span> enabling additional logging feature to debug below listed areas.</span><br><span class="line"></span><br><span class="line">Default=0</span><br><span class="line">MPT_DEBUG 0x00000001</span><br><span class="line">MPT_DEBUG_MSG_FRAME 0x00000002</span><br><span class="line">MPT_DEBUG_SG 0x00000004</span><br><span class="line">MPT_DEBUG_EVENTS 0x00000008</span><br><span class="line">MPT_DEBUG_EVENT_WORK_TASK 0x00000010</span><br><span class="line">MPT_DEBUG_INIT 0x00000020</span><br><span class="line">MPT_DEBUG_EXIT 0x00000040</span><br><span class="line">MPT_DEBUG_FAIL 0x00000080</span><br><span class="line">MPT_DEBUG_TM 0x00000100</span><br><span class="line">MPT_DEBUG_REPLY 0x00000200</span><br><span class="line">MPT_DEBUG_HANDSHAKE 0x00000400</span><br><span class="line">MPT_DEBUG_CONFIG 0x00000800</span><br><span class="line">MPT_DEBUG_DL 0x00001000</span><br><span class="line">MPT_DEBUG_RESET 0x00002000</span><br><span class="line">MPT_DEBUG_SCSI 0x00004000</span><br><span class="line">MPT_DEBUG_IOCTL 0x00008000</span><br><span class="line">MPT_DEBUG_CSMISAS 0x00010000</span><br><span class="line">MPT_DEBUG_SAS 0x00020000</span><br><span class="line">MPT_DEBUG_TRANSPORT 0x00040000</span><br><span class="line">MPT_DEBUG_TASK_SET_FULL 0x00080000</span><br><span class="line">sdev_queue_depth:</span><br><span class="line">This is the global setting <span class="keyword">for</span> SAS devices queue depth. This means Scsi Mid Layer can send commands to the drive until the number of pending commands reaches the <span class="built_in">set</span> queue depth.</span><br><span class="line">(Default Queue Depths: SAS -&gt; 254, SATA -&gt; 32, NVMe -&gt; 128)</span><br><span class="line"></span><br><span class="line">max_sectors:</span><br><span class="line">Driver imposed sector transfer <span class="built_in">limit</span>. It indicates the maximum number of sectors to transfer per SCSI IO <span class="built_in">command</span>. Max_sectors range [64 to 32767].</span><br><span class="line">Default=32767 (int)</span><br><span class="line"></span><br><span class="line">command_retry_count:</span><br><span class="line">The <span class="built_in">set</span> number of <span class="built_in">times</span> the internally SCSI Scan (e.g. Inquiry, TUR, Report Lun etc.) commands will be retired during drive discovery process when drive is hot added. Default=144 (int)</span><br><span class="line"></span><br><span class="line">missing_delay:</span><br><span class="line">This field has Device missing delay and Io missing delay as an array of Int. Device missing delay: The number of seconds the IOC will delay reporting a target device missing after it becomes unavailable. The device will not be reported as missing <span class="keyword">if</span> it returns before this timer expires.</span><br><span class="line"></span><br><span class="line">IO Missing Delay: The number of seconds the IOC will delay replying to SCSI Initiators request messages when the addressed device is missing because of the inability to access the target device.</span><br><span class="line"></span><br><span class="line">max_lun:</span><br><span class="line">This sets max_lun field <span class="keyword">in</span> the Scsi_Host data structure.</span><br><span class="line">Default=16895 (int)</span><br><span class="line"></span><br><span class="line">hbas_to_enumerate:</span><br><span class="line">A System might have multiple HBA’s. This option enables user to select the HBA’s to be managed by the driver.</span><br><span class="line">0 - Enumerates all SAS 2.0, PCIe HBA, SAS3.0 &amp; above generation</span><br><span class="line">of HBAs.</span><br><span class="line">1 - Enumerates only PCIe HBA &amp; SAS 2.0 generation HBAs.</span><br><span class="line">2 - Enumerates PCIe HBA, SAS 3.0 &amp; above generation HBAs.</span><br><span class="line">Default=-1 (Enumerates all SAS 2.0, PCIe HBA, SAS 3.0 &amp; above generation HBAs <span class="keyword">else</span> PCIe HBA, SAS 3.0 &amp; above generation HBAs only) (int)</span><br><span class="line"></span><br><span class="line">multipath_on_hba:</span><br><span class="line">Multipath support to add same target device as many <span class="built_in">times</span> as it is visible to HBA from various paths. Default=0 (Disabled) (int)</span><br><span class="line"></span><br><span class="line">disable_eedp:</span><br><span class="line">End-to-end Data Protection is a feature <span class="keyword">in</span> hard drives that extends error detection to cover the entire path from the computer system to the hard drive media and back. Default=0 (EEDP support is enabled) (uint)</span><br><span class="line"></span><br><span class="line">diag_buffer_enable:</span><br><span class="line">When this module parameter is <span class="built_in">set</span> <span class="keyword">then</span> corresponding diag buffers will be registered with the HBA firmware. Here are list of diag buffer that user can register.</span><br><span class="line">Bit fields <span class="keyword">for</span> diag_buffer_enable</span><br><span class="line">Bit 0 <span class="built_in">set</span> = TRACE</span><br><span class="line">Bit 1 <span class="built_in">set</span> = SNAPSHOT</span><br><span class="line">Bit 2 <span class="built_in">set</span> = EXTENDED</span><br><span class="line">Default=0 (none of the diag buffers will be registered)(int)</span><br><span class="line"></span><br><span class="line">disable_discovery:</span><br><span class="line">Setting this module parameter will disables discovery of attached drives.</span><br><span class="line">Default=0 (int)</span><br><span class="line"></span><br><span class="line">allow_drive_spindown:</span><br><span class="line">Allows host driver to issue START STOP UNIT (STOP) <span class="built_in">command</span> to spin down the drives before shutdown or driver unload.</span><br><span class="line">Default=1 (Spindown SSD but not HDD) (uint)</span><br><span class="line">0 =&gt; don’t Spindown any SATA drives.</span><br><span class="line">1 =&gt; Spindown SSD but not HDD</span><br><span class="line">2 =&gt; Spindown HDD but not SSD</span><br><span class="line">3 =&gt; Spindown all SATA drives</span><br><span class="line"></span><br><span class="line">prot_mask:</span><br><span class="line">Permits overriding the host protection capabilities mask. DIF defines the exchange of protection information between initiator and SBC block device (HBA and Disk). DIX defines the exchange of protection information between OS and initiator (OS and HBA).</span><br><span class="line">Bits <span class="keyword">for</span> enabling DIF/DIX</span><br><span class="line">SHOST_DIF_TYPE1_PROTECTION = 1 &lt;&lt; <span class="string">0</span></span><br><span class="line"><span class="string">SHOST_DIF_TYPE2_PROTECTION = 1 &lt;&lt; 1</span></span><br><span class="line"><span class="string">SHOST_DIF_TYPE3_PROTECTION = 1 &lt;&lt; 2</span></span><br><span class="line"><span class="string">SHOST_DIX_TYPE0_PROTECTION = 1 &lt;&lt; 3</span></span><br><span class="line"><span class="string">SHOST_DIX_TYPE1_PROTECTION = 1 &lt;&lt; 4</span></span><br><span class="line"><span class="string">SHOST_DIX_TYPE2_PROTECTION = 1 &lt;&lt; 5</span></span><br><span class="line"><span class="string">SHOST_DIX_TYPE3_PROTECTION = 1 &lt;&lt; 6</span></span><br><span class="line"><span class="string">Default=0x07 (DIX support is disabled and only DIF will be</span></span><br><span class="line"><span class="string">enabled) (int)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">protection_guard_mask:</span></span><br><span class="line"><span class="string">This permits overriding the host protection algorithm mask Available (T10 CRC/ IP Checksum).</span></span><br><span class="line"><span class="string">All DIX-capable initiators must support the T10-mandated CRC checksum. Controllers can optionally implement the IP checksum scheme which has much lower impact on system performance. Note that the main rationale for the checksum is to match integrity metadata with data.</span></span><br><span class="line"><span class="string">SHOST_DIX_GUARD_CRC = 1 &lt;&lt; 0</span></span><br><span class="line">SHOST_DIX_GUARD_IP = 1 &lt;&lt; <span class="string">1</span></span><br><span class="line"><span class="string">Default=3 (int)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">issue_scsi_cmd_to_bringup_drive: Setting this allows host driver to issue SCSI commands internally to bring the drive to READY state. Default=1</span> (int)</span><br><span class="line"></span><br><span class="line">sata_smart_polling: Setting this feature, allows polling <span class="keyword">for</span> smart errors on SATA drives.</span><br><span class="line">Default=0 (uint)</span><br><span class="line"></span><br><span class="line">max_queue_depth:</span><br><span class="line">User can use this to <span class="built_in">set</span> hba queue depth to be used by the controller. Max controller queue depth can be up to 30000 (int)</span><br><span class="line"></span><br><span class="line">max_sgl_entries:</span><br><span class="line">This allows user to specify the maximum number of ScatterGather entries per I/O. Default=128 <span class="keyword">in</span> most kernels. (Range 16 to 256) (int)</span><br><span class="line">The Linux “scatter/gather” table size needs to be large enough to allow IO_SIZE IO, <span class="keyword">if</span> possible. For most drivers, this typically requires a “sg_tablesize” value of 256 or greater <span class="keyword">for</span> 4MB IO. Different vendors have different defaults <span class="keyword">for</span> this parameter, and may require a modprobe.conf entry to increase the value. The QLogic driver defaults to a value of 1024. For Emulex, a modeprobe.conf entry needs to be added to increase the value to 256 or greater, such as:</span><br><span class="line">options lpfc lpfc_sg_seg_cnt=256</span><br><span class="line">The LSI SAS driver, “mpt2sas”, uses the parameter named “max_sgl_entries” to control this value. Its maximum value <span class="keyword">in</span> RHEL 6.x currently only 128.</span><br><span class="line">The value of sg_tablesize can be validated via:</span><br><span class="line"><span class="string">&#x27;cat /sys/class/scsi_host/host&#123;n&#125;/sg_tablesize&#x27;</span></span><br><span class="line"></span><br><span class="line">msix_disable:</span><br><span class="line">Setting 1 disables MSIX routed interrupts and uses legacy interrupts.</span><br><span class="line">Default=0 (int)</span><br><span class="line"></span><br><span class="line">smp_affinity_enable:</span><br><span class="line">This defines the CPU cores that are allowed to execute the ISR <span class="keyword">for</span> that IRQ. Setting this enables SMP affinity feature. Enable/Disable (1/0)</span><br><span class="line">Default=1 Enabled (int)</span><br><span class="line"></span><br><span class="line">max_msix_vectors:</span><br><span class="line">Controls the number of msix vectors to be used by mpt3sas driver. SAS3.0 controllers like Invader supports max 96 msix vectors SAS3.5 products like Ventura supports max 128 msix. (int)</span><br><span class="line"></span><br><span class="line">irqpoll_weight:</span><br><span class="line">irq poll weight is used as the budget <span class="keyword">in</span> processing of reply descriptors from reply descriptor post queues. Also once irqpoll_weight numbers of reply descriptors are continuously processed <span class="keyword">in</span> ISR context <span class="keyword">then</span> driver will quit from the ISR and invoke the irq polling thread to process the remaining reply descriptors.</span><br><span class="line">Default=one fourth of HBA queue depth. (int)</span><br><span class="line"></span><br><span class="line">mpt3sas_fwfault_debug:</span><br><span class="line">Setting this enables detection of firmware fault and halts firmware. Usually this is <span class="built_in">set</span> to collect the HBA FW logs during firmware fault.</span><br><span class="line">Default=0 (int)</span><br></pre></td></tr></table></figure>

<h4 id="Error-code"><a href="#Error-code" class="headerlink" title="Error code"></a><a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/v4.18.20/source/drivers/scsi/mpt3sas/mpi/mpi2_ioc.h">Error code</a></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#define MPI2_EVENT_LOG_DATA                         (0x0001)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_STATE_CHANGE                     (0x0002)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_HARD_RESET_RECEIVED              (0x0005)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_EVENT_CHANGE                     (0x000A)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_TASK_SET_FULL                    (0x000E)    /*obsolete */</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_SAS_DEVICE_STATUS_CHANGE         (0x000F)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_IR_OPERATION_STATUS              (0x0014)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_SAS_DISCOVERY                    (0x0016)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_SAS_BROADCAST_PRIMITIVE          (0x0017)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_SAS_INIT_DEVICE_STATUS_CHANGE    (0x0018)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_SAS_INIT_TABLE_OVERFLOW          (0x0019)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_SAS_TOPOLOGY_CHANGE_LIST         (0x001C)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_SAS_ENCL_DEVICE_STATUS_CHANGE    (0x001D)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_ENCL_DEVICE_STATUS_CHANGE        (0x001D)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_IR_VOLUME                        (0x001E)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_IR_PHYSICAL_DISK                 (0x001F)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_IR_CONFIGURATION_CHANGE_LIST     (0x0020)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_LOG_ENTRY_ADDED                  (0x0021)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_SAS_PHY_COUNTER                  (0x0022)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_GPIO_INTERRUPT                   (0x0023)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_HOST_BASED_DISCOVERY_PHY         (0x0024)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_SAS_QUIESCE                      (0x0025)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_SAS_NOTIFY_PRIMITIVE             (0x0026)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_TEMP_THRESHOLD                   (0x0027)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_HOST_MESSAGE                     (0x0028)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_POWER_PERFORMANCE_CHANGE         (0x0029)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_PCIE_DEVICE_STATUS_CHANGE        (0x0030)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_PCIE_ENUMERATION                 (0x0031)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_PCIE_TOPOLOGY_CHANGE_LIST        (0x0032)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_PCIE_LINK_COUNTER                (0x0033)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_ACTIVE_CABLE_EXCEPTION           (0x0034)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_SAS_DEVICE_DISCOVERY_ERROR       (0x0035)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_MIN_PRODUCT_SPECIFIC             (0x006E)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_MAX_PRODUCT_SPECIFIC             (0x007F)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_SAS_DEV_STAT_RC_SMART_DATA                           (0x05)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_SAS_DEV_STAT_RC_UNSUPPORTED                          (0x07)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_SAS_DEV_STAT_RC_INTERNAL_DEVICE_RESET                (0x08)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_SAS_DEV_STAT_RC_TASK_ABORT_INTERNAL                  (0x09)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_SAS_DEV_STAT_RC_ABORT_TASK_SET_INTERNAL              (0x0A)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_SAS_DEV_STAT_RC_CLEAR_TASK_SET_INTERNAL              (0x0B)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_SAS_DEV_STAT_RC_QUERY_TASK_INTERNAL                  (0x0C)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_SAS_DEV_STAT_RC_ASYNC_NOTIFICATION                   (0x0D)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_SAS_DEV_STAT_RC_CMP_INTERNAL_DEV_RESET               (0x0E)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_SAS_DEV_STAT_RC_CMP_TASK_ABORT_INTERNAL              (0x0F)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_SAS_DEV_STAT_RC_SATA_INIT_FAILURE                    (0x10)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_SAS_DEV_STAT_RC_EXPANDER_REDUCED_FUNCTIONALITY       (0x11)</span></span><br><span class="line"><span class="comment">#define MPI2_EVENT_SAS_DEV_STAT_RC_CMP_EXPANDER_REDUCED_FUNCTIONALITY   (0x12)</span></span><br></pre></td></tr></table></figure>
<p>example   </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[1:0:1:0]    enclosu DellEMC  Array584EMM      5258  -          -  /dev/sg1        -</span><br><span class="line"></span><br><span class="line"><span class="comment">### log show: ## log show all JBOD block devices are block, after a short time, all block device were unblock</span></span><br><span class="line">mpt3sas_cm0: log_info(0x30030101): originator(IOP), code(0x03), sub_code(0x0101)</span><br><span class="line">mpt3sas_cm0: log_info(0x30030101): originator(IOP), code(0x03), sub_code(0x0101)</span><br><span class="line"><span class="comment">## mpt3sas driver error handle</span></span><br><span class="line">ses 1:0:1:0: _scsih_block_io_device skip device_block <span class="keyword">for</span> SES handle(0x006b)</span><br><span class="line">sd 1:0:0:0: device_block, handle(0x006c)</span><br><span class="line">sd 1:0:2:0: device_block, handle(0x006d)</span><br></pre></td></tr></table></figure>
<p>The 32-bit IOCLogInfo field in the Reply message is used to relay information back to the host. The information can be error codes when an error occurs, or just information about the message.The IOCLogInfo field of the Reply Message has the following subfields:<br>[31:28] MPI_IOCLOGINFO_TYPE_SAS (3)<br>[27:24] IOC_LOGINFO_ORIGINATOR: 0 &#x3D; IOP, 1 &#x3D; PL, 2 &#x3D; IR<br>[23:16] LOGINFO_CODE<br>[15:0]  LOGINFO_CODE Specific<br>LOGINFO_CODE Specific</p>
<p>0x3(MPI_IOCLOGINFO_TYPE_SAS) 0 03 0101</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tail -n 15 ./drivers/message/fusion/lsi/mpi.h</span></span><br><span class="line"><span class="comment">/****************************************************************************/</span></span><br><span class="line"><span class="comment">/*  LogInfo Types                                                           */</span></span><br><span class="line"><span class="comment">/****************************************************************************/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MPI_IOCLOGINFO_TYPE_MASK                (0xF0000000)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MPI_IOCLOGINFO_TYPE_SHIFT               (28)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MPI_IOCLOGINFO_TYPE_NONE                (0x0)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MPI_IOCLOGINFO_TYPE_SCSI                (0x1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MPI_IOCLOGINFO_TYPE_FC                  (0x2)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MPI_IOCLOGINFO_TYPE_SAS                 (0x3)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MPI_IOCLOGINFO_TYPE_ISCSI               (0x4)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MPI_IOCLOGINFO_LOG_DATA_MASK            (0x0FFFFFFF)</span></span><br></pre></td></tr></table></figure>

<p>0x3 0(means originator is IOP) 03 0101   </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//./drivers/message/fusion/mptbase.c</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> (sas_loginfo.dw.originator) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">case</span> <span class="number">0</span>:  <span class="comment">/* IOP */</span></span><br><span class="line">                        <span class="keyword">if</span> (sas_loginfo.dw.code &lt;</span><br><span class="line">                            ARRAY_SIZE(iop_code_str))</span><br><span class="line">                                code_desc = iop_code_str[sas_loginfo.dw.code];</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">1</span>:  <span class="comment">/* PL */</span></span><br><span class="line">                        <span class="keyword">if</span> (sas_loginfo.dw.code &lt;</span><br><span class="line">                            ARRAY_SIZE(pl_code_str))</span><br><span class="line">                                code_desc = pl_code_str[sas_loginfo.dw.code];</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">2</span>:  <span class="comment">/* IR */</span></span><br><span class="line">                        <span class="keyword">if</span> (sas_loginfo.dw.code &gt;=</span><br><span class="line">                            ARRAY_SIZE(ir_code_str))</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                        code_desc = ir_code_str[sas_loginfo.dw.code];</span><br><span class="line">                        <span class="keyword">if</span> (sas_loginfo.dw.subcode &gt;=</span><br><span class="line">                            ARRAY_SIZE(raid_sub_code_str))</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">if</span> (sas_loginfo.dw.code == <span class="number">0</span>)</span><br><span class="line">                                sub_code_desc =</span><br><span class="line">                                    raid_sub_code_str[sas_loginfo.dw.subcode];</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                        <span class="keyword">return</span>;</span><br></pre></td></tr></table></figure>

<p>0x3 0 03(code(0x03), IOP_LOGINFO_CODE_CONFIG_INVALID_PAGE) 0101</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x00030000</span>  <span class="string">IOP_LOGINFO_CODE_CONFIG_INVALID_PAGE</span>  <span class="string">Not</span> <span class="string">used</span></span><br><span class="line"></span><br><span class="line"><span class="string">//./drivers/message/fusion/lsi/mpi_log_sas.h</span></span><br><span class="line"><span class="comment">#define IOP_LOGINFO_CODE_CONFIG_INVALID_PAGE                 (0x00030000)</span></span><br></pre></td></tr></table></figure>

<p>0x3 0 03 0101(sub_code(0x0101))<br>0x00030100, I guess the last bit has the more details.<br>The error show the “Route Table Entry not found”</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//./drivers/message/fusion/lsi/mpi_log_sas.h</span></span><br><span class="line"><span class="comment">// show all IOP ERROR CODE</span></span><br><span class="line">grep -R IOP_LOGINFO ./drivers/message<span class="comment">/*</span></span><br><span class="line"><span class="comment">------------------------------------------23:0 bit-----------------------------------------------------------</span></span><br><span class="line"><span class="comment">                                                                                                            |</span></span><br><span class="line"><span class="comment">                                                                                                            |</span></span><br><span class="line"><span class="comment">                                                                                                            V</span></span><br><span class="line"><span class="comment">./drivers/message/fusion/lsi/mpi_log_sas.h:#define IOP_LOGINFO_CODE_INVALID_SAS_ADDRESS                 (0x00010000)</span></span><br><span class="line"><span class="comment">./drivers/message/fusion/lsi/mpi_log_sas.h:#define IOP_LOGINFO_CODE_UNUSED2                             (0x00020000)</span></span><br><span class="line"><span class="comment">./drivers/message/fusion/lsi/mpi_log_sas.h:#define IOP_LOGINFO_CODE_CONFIG_INVALID_PAGE                 (0x00030000)</span></span><br><span class="line"><span class="comment">./drivers/message/fusion/lsi/mpi_log_sas.h:#define IOP_LOGINFO_CODE_CONFIG_INVALID_PAGE_RT              (0x00030100) /* Route Table Entry not found */</span></span><br><span class="line">./drivers/message/fusion/lsi/mpi_log_sas.h:<span class="meta">#<span class="keyword">define</span> IOP_LOGINFO_CODE_CONFIG_INVALID_PAGE_PN              (0x00030200) <span class="comment">/* Invalid Page Number */</span></span></span><br><span class="line">./drivers/message/fusion/lsi/mpi_log_sas.h:<span class="meta">#<span class="keyword">define</span> IOP_LOGINFO_CODE_CONFIG_INVALID_PAGE_FORM            (0x00030300) <span class="comment">/* Invalid FORM */</span></span></span><br><span class="line">./drivers/message/fusion/lsi/mpi_log_sas.h:<span class="meta">#<span class="keyword">define</span> IOP_LOGINFO_CODE_CONFIG_INVALID_PAGE_PT              (0x00030400) <span class="comment">/* Invalid Page Type */</span></span></span><br><span class="line">./drivers/message/fusion/lsi/mpi_log_sas.h:<span class="meta">#<span class="keyword">define</span> IOP_LOGINFO_CODE_CONFIG_INVALID_PAGE_DNM             (0x00030500) <span class="comment">/* Device Not Mapped */</span></span></span><br><span class="line">./drivers/message/fusion/lsi/mpi_log_sas.h:<span class="meta">#<span class="keyword">define</span> IOP_LOGINFO_CODE_CONFIG_INVALID_PAGE_PERSIST         (0x00030600) <span class="comment">/* Persistent Page not found */</span></span></span><br><span class="line">./drivers/message/fusion/lsi/mpi_log_sas.h:<span class="meta">#<span class="keyword">define</span> IOP_LOGINFO_CODE_CONFIG_INVALID_PAGE_DEFAULT         (0x00030700) <span class="comment">/* Default Page not found */</span></span></span><br><span class="line">./drivers/message/fusion/lsi/mpi_log_sas.h:<span class="meta">#<span class="keyword">define</span> IOP_LOGINFO_CODE_FWUPLOAD_NO_FLASH_AVAILABLE         (0x0003E000) <span class="comment">/* Tried to upload from flash, but there is none */</span></span></span><br><span class="line">./drivers/message/fusion/lsi/mpi_log_sas.h:<span class="meta">#<span class="keyword">define</span> IOP_LOGINFO_CODE_FWUPLOAD_UNKNOWN_IMAGE_TYPE         (0x0003E001) <span class="comment">/* ImageType field contents were invalid */</span></span></span><br><span class="line">./drivers/message/fusion/lsi/mpi_log_sas.h:<span class="meta">#<span class="keyword">define</span> IOP_LOGINFO_CODE_FWUPLOAD_WRONG_IMAGE_SIZE           (0x0003E002) <span class="comment">/* ImageSize field in TCSGE was bad/offset in MfgPg 4 was wrong */</span></span></span><br><span class="line">./drivers/message/fusion/lsi/mpi_log_sas.h:<span class="meta">#<span class="keyword">define</span> IOP_LOGINFO_CODE_FWUPLOAD_ENTIRE_FLASH_UPLOAD_FAILED (0x0003E003) <span class="comment">/* Error occurred while attempting to upload the entire flash */</span></span></span><br><span class="line">./drivers/message/fusion/lsi/mpi_log_sas.h:<span class="meta">#<span class="keyword">define</span> IOP_LOGINFO_CODE_FWUPLOAD_REGION_UPLOAD_FAILED       (0x0003E004) <span class="comment">/* Error occurred while attempting to upload single flash region */</span></span></span><br><span class="line">./drivers/message/fusion/lsi/mpi_log_sas.h:<span class="meta">#<span class="keyword">define</span> IOP_LOGINFO_CODE_FWUPLOAD_DMA_FAILURE                (0x0003E005) <span class="comment">/* Problem occurred while DMAing FW to host memory */</span></span></span><br><span class="line">./drivers/message/fusion/lsi/mpi_log_sas.h:<span class="meta">#<span class="keyword">define</span> IOP_LOGINFO_CODE_DIAG_MSG_ERROR                      (0x00040000) <span class="comment">/* Error handling diag msg - or&#x27;d with diag status */</span></span></span><br><span class="line">./drivers/message/fusion/lsi/mpi_log_sas.h:<span class="meta">#<span class="keyword">define</span> IOP_LOGINFO_CODE_TASK_TERMINATED                     (0x00050000)</span></span><br><span class="line">./drivers/message/fusion/lsi/mpi_log_sas.h:<span class="meta">#<span class="keyword">define</span> IOP_LOGINFO_CODE_ENCL_MGMT_READ_ACTION_ERR0R         (0x00060001) <span class="comment">/* Read Action not supported for SEP msg */</span></span></span><br><span class="line">./drivers/message/fusion/lsi/mpi_log_sas.h:<span class="meta">#<span class="keyword">define</span> IOP_LOGINFO_CODE_ENCL_MGMT_INVALID_BUS_ID_ERR0R      (0x00060002) <span class="comment">/* Invalid Bus/ID in SEP msg */</span></span></span><br><span class="line">./drivers/message/fusion/lsi/mpi_log_sas.h:<span class="meta">#<span class="keyword">define</span> IOP_LOGINFO_CODE_TARGET_ASSIST_TERMINATED            (0x00070001)</span></span><br><span class="line">./drivers/message/fusion/lsi/mpi_log_sas.h:<span class="meta">#<span class="keyword">define</span> IOP_LOGINFO_CODE_TARGET_STATUS_SEND_TERMINATED       (0x00070002)</span></span><br><span class="line">./drivers/message/fusion/lsi/mpi_log_sas.h:<span class="meta">#<span class="keyword">define</span> IOP_LOGINFO_CODE_TARGET_MODE_ABORT_ALL_IO            (0x00070003)</span></span><br><span class="line">./drivers/message/fusion/lsi/mpi_log_sas.h:<span class="meta">#<span class="keyword">define</span> IOP_LOGINFO_CODE_TARGET_MODE_ABORT_EXACT_IO          (0x00070004)</span></span><br><span class="line">./drivers/message/fusion/lsi/mpi_log_sas.h:<span class="meta">#<span class="keyword">define</span> IOP_LOGINFO_CODE_TARGET_MODE_ABORT_EXACT_IO_REQ      (0x00070005)</span></span><br><span class="line">./drivers/message/fusion/lsi/mpi_log_sas.h:<span class="meta">#<span class="keyword">define</span> IOP_LOGINFO_CODE_LOG_TIMESTAMP_EVENT                 (0x00080000)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mpt3sas_cm0:</span> <span class="string">log_info(0x31140000):</span> <span class="string">originator(PL),</span> <span class="string">code(0x14),</span> <span class="string">sub_code(0x0000)</span></span><br></pre></td></tr></table></figure>
<p>0x3 (SAS) 1 (PL) 14(PL_LOGINFO_CODE_IO_EXECUTED) 0000(PL_LOGINFO_CODE_IO_EXECUTED)<br>0x00140000   PL_LOGINFO_CODE_IO_EXECUTED  I&#x2F;O Aborted (host issued task management) after sent to target.     </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mpt3sas_cm0:</span> <span class="string">log_info(0x31120436):</span> <span class="string">originator(PL),</span> <span class="string">code(0x12),</span> <span class="string">sub_code(0x0436)</span></span><br></pre></td></tr></table></figure>
<p>0x3 (SAS) 1 (PL) 12(PL_LOGINFO_CODE_ABORT) 0400(PL_LOGINFO_SUB_CODE_FRAME_XFER_ERROR)     </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Bits 0-3 encode Transport Status Register (offset 0x08) */</span></span><br><span class="line"><span class="comment">/* Bit 0 is Status Bit 0: FrameXferErr */</span></span><br><span class="line"><span class="comment">/* Bit 1 &amp; 2 are Status Bits 16 and 17: FrameXmitErrStatus */</span></span><br><span class="line"><span class="comment">/* Bit 3 is Status Bit 18 WriteDataLenghtGTDataLengthErr */</span></span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">      <span class="type">char</span>               *name;</span><br><span class="line">      <span class="type">int</span>                (* detect)(<span class="type">int</span>);</span><br><span class="line">      <span class="type">const</span> <span class="type">char</span>         *(* info)(<span class="type">void</span>);</span><br><span class="line">      <span class="type">int</span>                (* queuecommand)(Scsi_Cmnd *,</span><br><span class="line">                          <span class="type">void</span> (*done)(Scsi_Cmnd *));</span><br><span class="line">      <span class="type">int</span>                (* command)(Scsi_Cmnd *);</span><br><span class="line">      <span class="type">int</span>                (* <span class="built_in">abort</span>)(Scsi_Cmnd *, <span class="type">int</span>);</span><br><span class="line">      <span class="type">int</span>                (* reset)(<span class="type">void</span>);</span><br><span class="line">      <span class="type">int</span>                (* slave_attach)(<span class="type">int</span>, <span class="type">int</span>);</span><br><span class="line">      <span class="type">int</span>                (* bios_param)(<span class="type">int</span>, <span class="type">int</span>, <span class="type">int</span> []);</span><br><span class="line">      <span class="type">int</span>                can_queue;</span><br><span class="line">      <span class="type">int</span>                this_id;</span><br><span class="line">      <span class="type">short</span> <span class="type">unsigned</span> <span class="type">int</span> sg_tablesize;</span><br><span class="line">      <span class="type">short</span>              cmd_per_lun;</span><br><span class="line">      <span class="type">unsigned</span>           present:<span class="number">1</span>;</span><br><span class="line">      <span class="type">unsigned</span>           unchecked_isa_dma:<span class="number">1</span>;</span><br><span class="line">    &#125; Scsi_Host;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>cmd_per_lun   </p>
<ul>
<li>The SCSI standard supports the notion of &#96;&#96;linked commands.’’ Linked commands allow several commands to be queued consecutively to a single SCSI device. The cmd_per_lun variable specifies the number of linked commands allowed. This variable should be set to 1 if command linking is not supported. At this time, however, the high-level SCSI code will not take advantage of this feature.</li>
<li>This variable should be set to 1 if command linking is not supported.</li>
</ul>
</li>
<li><p>can_queue</p>
<ul>
<li>can_queue holds the number of outstanding commands the host adapter can process. Unless RESELECTION is supported by the driver and the driver is interrupt-driven, (some of the early Linux drivers were not interrupt driven and, consequently, had very poor performance) this variable should be set to 1.</li>
</ul>
</li>
</ul>
<p>compare mpt3sas and lpfc dirver  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">$ ls</span><br><span class="line">active_mode     device_delay         fw_queue_depth            io_delay           sg_prot_tablesize  use_blk_mq</span><br><span class="line">board_assembly  diag_trigger_event   host_busy                 logging_level      sg_tablesize       version_bios</span><br><span class="line">board_name      diag_trigger_master  host_reset                power              state              version_fw</span><br><span class="line">board_tracer    diag_trigger_mpi     host_sas_address          proc_name          subsystem          version_mpi</span><br><span class="line">BRM_status      diag_trigger_scsi    host_trace_buffer         prot_capabilities  supported_mode     version_nvdata_default</span><br><span class="line">can_queue       drv_support_bitmap   host_trace_buffer_enable  prot_guard_type    uevent             version_nvdata_persistent</span><br><span class="line">cmd_per_lun     eh_deadline          host_trace_buffer_size    reply_queue_count  unchecked_isa_dma  version_product</span><br><span class="line">device          fwfault_debug        ioc_reset_count           scan               unique_id</span><br><span class="line"></span><br><span class="line">$ cat fw_queue_depth</span><br><span class="line">10048</span><br><span class="line"></span><br><span class="line">## lpfc </span><br><span class="line">$ cat lpfc_lun_queue_depth</span><br><span class="line">30</span><br><span class="line">$ cat lpfc_hba_queue_depth</span><br><span class="line">2821</span><br><span class="line">$ cat lpfc_tgt_queue_depth</span><br><span class="line">65535</span><br><span class="line"></span><br><span class="line">ls /sys/devices/pci0000:5d/0000:5d:00.0/0000:5e:00.1/host18/scsi_host/host18/</span><br><span class="line">active_mode             lpfc_cr_delay              lpfc_fdmi_on             lpfc_poll                 lpfc_xlane_lun_state   prot_capabilities</span><br><span class="line">bg_apptag_err           lpfc_devloss_tmo           lpfc_fips_level          lpfc_poll_tmo             lpfc_xlane_lun_status  prot_guard_type</span><br><span class="line">bg_guard_err            lpfc_drvr_stat_data        lpfc_fips_rev            lpfc_ras_fwlog_buffsize   lpfc_xlane_priority    protocol</span><br><span class="line">bg_info                 lpfc_drvr_version          lpfc_first_burst_size    lpfc_ras_fwlog_func       lpfc_XLanePriority     scan</span><br><span class="line">bg_reftag_err           lpfc_dss                   lpfc_hba_queue_depth     lpfc_ras_fwlog_level      lpfc_xlane_supported   serialnum</span><br><span class="line">board_mode              lpfc_enable_bbcr           lpfc_iocb_cnt            lpfc_req_fw_upgrade       lpfc_xlane_tgt         sg_prot_tablesize</span><br><span class="line">can_queue               lpfc_enable_bg             lpfc_link_speed          lpfc_scan_down            lpfc_xlane_vpt         sg_tablesize</span><br><span class="line">cmd_per_lun             lpfc_enable_dpp            lpfc_log_verbose         lpfc_sg_seg_cnt           lpfc_xri_split         state</span><br><span class="line">ctlreg                  lpfc_enable_fc4_type       lpfc_lun_queue_depth     lpfc_soft_wwn_enable      max_rpi                subsystem</span><br><span class="line">device                  lpfc_enable_fip            lpfc_max_luns            lpfc_soft_wwnn            max_vpi                supported_mode</span><br><span class="line">eh_deadline             lpfc_enable_hba_heartbeat  lpfc_max_scsicmpl_time   lpfc_soft_wwpn            max_xri                txcmplq_hw</span><br><span class="line">fwrev                   lpfc_enable_hba_reset      lpfc_multi_ring_rctl     lpfc_sriov_hw_max_virtfn  mbox                   txq_hw</span><br><span class="line">hdw                     lpfc_enable_mds_diags      lpfc_multi_ring_support  lpfc_sriov_nr_virtfn      menlo_mgmt_mode        uevent</span><br><span class="line">host_busy               lpfc_enable_npiv           lpfc_multi_ring_type     lpfc_stat_data_ctrl       modeldesc              unchecked_isa_dma</span><br><span class="line">host_reset              lpfc_enable_rrq            lpfc_nodev_tmo           lpfc_suppress_link_up     modelname              unique_id</span><br><span class="line">info                    lpfc_enable_SmartSAN       lpfc_ns_query            lpfc_suppress_rsp         npiv_info              use_blk_mq</span><br><span class="line">iocb_hw                 lpfc_EnableXLane           lpfc_nvme_embed_cmd      lpfc_task_mgmt_tmo        nport_evt_cnt          used_rpi</span><br><span class="line">issue_reset             lpfc_fcf_failover_policy   lpfc_nvme_enable_fb      lpfc_temp_sensor          num_discovered_ports   used_vpi</span><br><span class="line">link_state              lpfc_fcp2_no_tgt_reset     lpfc_nvme_io_channel     lpfc_tgt_queue_depth      nvme_info              used_xri</span><br><span class="line">lpfc_ack0               lpfc_fcp_class             lpfc_nvme_oas            lpfc_topology             option_rom_version</span><br><span class="line">lpfc_aer_state_cleanup  lpfc_fcp_cpu_map           lpfc_nvmet_fb_size       lpfc_use_adisc            portnum</span><br><span class="line">lpfc_aer_support        lpfc_fcp_imax              lpfc_nvmet_mrq           lpfc_use_blk_mq           power</span><br><span class="line">lpfc_auto_imax          lpfc_fcp_io_channel        lpfc_nvmet_mrq_post      lpfc_use_msi              proc_name</span><br><span class="line">lpfc_cr_count           lpfc_fcp_io_sched          lpfc_peer_port_login     lpfc_xlane_lun            programtype</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://www.ibm.com/support/pages/warning-message-multiple-lsi-controllers-installed-ibm-bladecenter-hs12-type-8028#:~:text=The%20message%20%22Adapter%20configuration%20may,the%20user%20to%20define%20this.">9300 show “Adapter configuration may have changed, reconfiguration is suggested!” in BIOS and restore the default setting</a></p>
<ul>
<li>Press CTRL-C to enter the SAS Configuration Utility.</li>
<li>User the arrow key to move over to the boot order of each adapter.</li>
<li>Use the Insert and Delete keys to change the boot order.</li>
</ul>
<h3 id="qlogic-driver-debug"><a href="#qlogic-driver-debug" class="headerlink" title="qlogic driver debug"></a>qlogic driver debug</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> 1 &gt;/sys/module/qla2xxx/parameters/ql2xextended_error_logging</span><br></pre></td></tr></table></figure>

  </div>
</article>


    <div class="blog-post-comments">
        <div id="utterances_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>


        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a target="_blank" rel="noopener" href="http://github.com/probberechts">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#Name-Decoder"><span class="toc-number">1.</span> <span class="toc-text">Name Decoder</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Got-megaraid-log"><span class="toc-number">2.</span> <span class="toc-text">Got megaraid log</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#show-dev-sn"><span class="toc-number"></span> <span class="toc-text">show dev sn</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Set-time"><span class="toc-number">1.</span> <span class="toc-text">Set time</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Set-cache-policy"><span class="toc-number">2.</span> <span class="toc-text">Set cache policy</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Create-raid10"><span class="toc-number">3.</span> <span class="toc-text">Create raid10</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Megaraid-FastPATH-for-SAS-x2F-SATA-SSD"><span class="toc-number">4.</span> <span class="toc-text">Megaraid FastPATH for SAS&#x2F;SATA SSD</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#case-1"><span class="toc-number">4.1.</span> <span class="toc-text">case 1</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cachevault"><span class="toc-number">5.</span> <span class="toc-text">Cachevault</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Get-all-megaraid-log-not-filter"><span class="toc-number">6.</span> <span class="toc-text">Get all megaraid log, not filter</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Show-raid-logic-info"><span class="toc-number">7.</span> <span class="toc-text">Show raid logic info</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Import-license"><span class="toc-number">8.</span> <span class="toc-text">Import license</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Backup-config"><span class="toc-number">9.</span> <span class="toc-text">Backup config</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Interrupt-BGI"><span class="toc-number">10.</span> <span class="toc-text">Interrupt BGI</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Rebuild-x2F-Migrate-x2F-init"><span class="toc-number">11.</span> <span class="toc-text">Rebuild&#x2F;Migrate&#x2F;init</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Make-device-good"><span class="toc-number">12.</span> <span class="toc-text">Make device good</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Make-JBOD"><span class="toc-number">13.</span> <span class="toc-text">Make JBOD</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Foreign-devices"><span class="toc-number">14.</span> <span class="toc-text">Foreign devices</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#About-Consistency-and-patrol-read"><span class="toc-number">15.</span> <span class="toc-text">About Consistency and patrol read</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Patrol-read"><span class="toc-number">15.1.</span> <span class="toc-text">Patrol read</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Consistency-Check"><span class="toc-number">16.</span> <span class="toc-text">Consistency Check</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Montor-cache-ECC-count"><span class="toc-number">17.</span> <span class="toc-text">Montor cache ECC count</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#About-device-write-cache-in-megaraid"><span class="toc-number">18.</span> <span class="toc-text">About device write cache in megaraid</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Flush-RAID-write-cache"><span class="toc-number">19.</span> <span class="toc-text">Flush RAID write cache</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#show-PHY"><span class="toc-number">20.</span> <span class="toc-text">show PHY</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Foreign-configurations"><span class="toc-number"></span> <span class="toc-text">Foreign configurations</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Dimmer-switch"><span class="toc-number">1.</span> <span class="toc-text">Dimmer switch</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Device"><span class="toc-number"></span> <span class="toc-text">Device</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#debug"><span class="toc-number">1.</span> <span class="toc-text">debug</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#log"><span class="toc-number">1.1.</span> <span class="toc-text">log</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Encolsure"><span class="toc-number">1.2.</span> <span class="toc-text">Encolsure</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#phy-err"><span class="toc-number">1.3.</span> <span class="toc-text">phy err</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#diag-adapter"><span class="toc-number">2.</span> <span class="toc-text">diag adapter</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Enable-SEP-for-Dell-PERC"><span class="toc-number">3.</span> <span class="toc-text">Enable SEP for Dell PERC</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Enable-JBOD"><span class="toc-number">4.</span> <span class="toc-text">Enable JBOD</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SAS-loading-balance"><span class="toc-number">5.</span> <span class="toc-text">SAS loading balance</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Driver-performance"><span class="toc-number">6.</span> <span class="toc-text">Driver performance</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Get-smart-info-from-LSI-megaraid"><span class="toc-number">7.</span> <span class="toc-text">Get smart info from LSI megaraid</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#performance-monitor"><span class="toc-number">8.</span> <span class="toc-text">performance monitor</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#T10-PI-for-megaraid"><span class="toc-number"></span> <span class="toc-text">T10 PI for megaraid</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#About-T10-rebuild-assist-for-megaraid"><span class="toc-number"></span> <span class="toc-text">About T10 rebuild assist for megaraid</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Enable-T10-data-protection-in-LSI-9380-8e"><span class="toc-number">1.</span> <span class="toc-text">Enable T10-data-protection in LSI 9380-8e</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Create-raid-and-enable-T10-pi-data-protection"><span class="toc-number">2.</span> <span class="toc-text">Create raid and enable T10-pi data protection</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Redhat-support"><span class="toc-number">3.</span> <span class="toc-text">Redhat support</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Upgrade-LSI-9500"><span class="toc-number">4.</span> <span class="toc-text">Upgrade LSI 9500</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Error-code"><span class="toc-number">5.</span> <span class="toc-text">Error code</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#qlogic-driver-debug"><span class="toc-number"></span> <span class="toc-text">qlogic driver debug</span></a>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2022/11/14/lsi/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2022/11/14/lsi/&text=LSI MegaRAID Fusion-MPT"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2022/11/14/lsi/&title=LSI MegaRAID Fusion-MPT"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2022/11/14/lsi/&is_video=false&description=LSI MegaRAID Fusion-MPT"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=LSI MegaRAID Fusion-MPT&body=Check out this article: http://example.com/2022/11/14/lsi/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2022/11/14/lsi/&title=LSI MegaRAID Fusion-MPT"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2022/11/14/lsi/&title=LSI MegaRAID Fusion-MPT"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2022/11/14/lsi/&title=LSI MegaRAID Fusion-MPT"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2022/11/14/lsi/&title=LSI MegaRAID Fusion-MPT"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2022/11/14/lsi/&name=LSI MegaRAID Fusion-MPT&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2022/11/14/lsi/&t=LSI MegaRAID Fusion-MPT"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2022
    John Doe
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/probberechts">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

    <script type="text/javascript">
      var utterances_repo = '67e8c052/67e8c052.github.io';
      var utterances_issue_term = 'pathname';
      var utterances_label = 'blog-comments';
      var utterances_theme = 'github-dark';

      (function(){
          var script = document.createElement('script');

          script.src = 'https://utteranc.es/client.js';
          script.setAttribute('repo', utterances_repo);
          script.setAttribute('issue-term', 'pathname');
          script.setAttribute('label', utterances_label);
          script.setAttribute('theme', utterances_theme);
          script.setAttribute('crossorigin', 'anonymous');
          script.async = true;
          (document.getElementById('utterances_thread')).appendChild(script);
      }());
  </script>

</body>
</html>
